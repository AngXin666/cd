# 租赁端开发任务清单

## 需求概述
创建一个新的租赁端，专门用于管理车辆租赁业务。

## 核心需求
1. ✅ 新增租赁管理员角色（lease_admin）
2. ✅ 固定登录账号：15766121960
3. ✅ 仅支持验证码登录
4. ✅ 租赁信息的完整 CRUD 功能
5. ✅ 独立的租赁端工作台

## 实施计划

### 阶段1：数据库改造
- [x] 1.1 添加 lease_admin 角色类型
- [x] 1.2 创建租赁管理员账号（15766121960）
- [x] 1.3 更新 RLS 策略，支持租赁管理员权限
- [x] 1.4 确保租赁管理员可以管理所有租赁信息
- [x] 1.5 创建 vehicle_leases 表

### 阶段2：类型定义更新
- [x] 2.1 更新 UserRole 类型，添加 lease_admin
- [x] 2.2 添加 VehicleLease 接口定义
- [x] 2.3 添加租赁相关 API 函数

### 阶段3：创建租赁端页面
- [x] 3.1 创建租赁端工作台（pages/lease-admin/index.tsx）
- [x] 3.2 创建租赁列表页面
- [ ] 3.3 创建添加租赁页面
- [ ] 3.4 创建编辑租赁页面
- [ ] 3.5 创建租赁详情页面

### 阶段4：路由配置
- [x] 4.1 添加租赁端路由到 app.config.ts
- [x] 4.2 配置页面标题和导航栏
- [x] 4.3 更新首页角色跳转逻辑

### 阶段5：登录验证
- [x] 5.1 更新登录页面，支持租赁管理员登录
- [x] 5.2 限制租赁管理员只能使用验证码登录
- [x] 5.3 验证手机号为 15766121960

### 阶段6：权限系统
- [x] 6.1 更新 TenantContext，支持租赁管理员
- [x] 6.2 更新权限检查函数
- [x] 6.3 确保租赁管理员可以访问所有租赁数据

### 阶段7：功能实现
- [x] 7.1 实现租赁列表查询
- [ ] 7.2 实现添加租赁功能
- [ ] 7.3 实现编辑租赁功能
- [x] 7.4 实现删除租赁功能
- [ ] 7.5 实现租赁详情查看

### 阶段8：测试验证
- [ ] 8.1 测试登录功能
- [ ] 8.2 测试租赁 CRUD 功能
- [ ] 8.3 测试权限控制
- [ ] 8.4 测试数据隔离

## 当前进度
正在实施阶段3：创建租赁端页面（已完成工作台和列表页面）

## 技术要点

### 角色定义
- 角色名称：lease_admin（租赁管理员）
- 登录账号：15766121960
- 登录方式：仅验证码登录
- 权限范围：所有租赁信息的完整管理权限

### 页面结构
```
pages/lease-admin/
  ├── index.tsx                 # 租赁端工作台
  ├── lease-list/
  │   └── index.tsx            # 租赁列表
  ├── add-lease/
  │   └── index.tsx            # 添加租赁
  ├── edit-lease/
  │   └── index.tsx            # 编辑租赁
  └── lease-detail/
      └── index.tsx            # 租赁详情
```

### 权限矩阵
| 操作 | 租赁管理员 | 超级管理员 | 车队长 | 司机 |
|------|-----------|-----------|--------|------|
| 查看所有租赁 | ✅ | ✅ | ✅ | ❌ |
| 创建租赁 | ✅ | ✅ | ❌ | ❌ |
| 编辑租赁 | ✅ | ✅ | ❌ | ❌ |
| 删除租赁 | ✅ | ✅ | ❌ | ❌ |

## 注意事项
1. 租赁管理员只能通过验证码登录
2. 手机号固定为 15766121960
3. 租赁管理员可以管理所有租赁信息
4. 需要更新多租户权限系统
5. 需要更新 RLS 策略
