# è®¡ä»¶ç®¡ç†å…¨åŠŸèƒ½å¤šç§Ÿæˆ·é€‚é…æ£€æŸ¥æŠ¥å‘Š

## ğŸ“‹ æ£€æŸ¥æ¦‚è¿°

å…¨é¢æ£€æŸ¥è®¡ä»¶ç®¡ç†ç³»ç»Ÿçš„æ‰€æœ‰åŠŸèƒ½æ˜¯å¦æ­£ç¡®é€‚é…å¤šç§Ÿæˆ·æ¶æ„ï¼ˆæ¯ä¸ªç§Ÿæˆ·ä½¿ç”¨ç‹¬ç«‹æ•°æ®åº“æ¨¡å¼ï¼‰ã€‚

## ğŸ” æ£€æŸ¥èŒƒå›´

### 1. è®¡ä»¶è®°å½•åŠŸèƒ½
- âŒ åˆ›å»ºè®¡ä»¶è®°å½•
- âœ… æŸ¥è¯¢è®¡ä»¶è®°å½•
- âœ… æ›´æ–°è®¡ä»¶è®°å½•
- âœ… åˆ é™¤è®¡ä»¶è®°å½•

### 2. è®¡ä»¶ä»·æ ¼ç®¡ç†
- âŒ åˆ›å»º/æ›´æ–°ä»·æ ¼é…ç½®
- âŒ æ‰¹é‡åˆ›å»º/æ›´æ–°ä»·æ ¼é…ç½®
- âœ… æŸ¥è¯¢ä»·æ ¼é…ç½®
- âœ… åˆ é™¤ä»·æ ¼é…ç½®

### 3. è®¡ä»¶ç»Ÿè®¡åŠŸèƒ½
- âœ… è®¡ä»¶ç»Ÿè®¡
- âœ… ç”¨æˆ·è®¡ä»¶ç»Ÿè®¡
- âœ… ä»“åº“è®¡ä»¶ç»Ÿè®¡

## ğŸ“Š è¯¦ç»†æ£€æŸ¥ç»“æœ

### âœ… å·²æ­£ç¡®é€‚é…çš„åŠŸèƒ½

#### 1. æŸ¥è¯¢è®¡ä»¶è®°å½• - âœ… ä¾èµ– RLS ç­–ç•¥
**å‡½æ•°**ï¼š
- `getPieceWorkRecordsByUser(userId, year, month)` - è·å–ç”¨æˆ·è®¡ä»¶è®°å½•
- `getPieceWorkRecordsByWarehouse(warehouseId, year, month)` - è·å–ä»“åº“è®¡ä»¶è®°å½•
- `getPieceWorkRecordsByUserAndWarehouse(...)` - è·å–ç”¨æˆ·åœ¨ä»“åº“çš„è®¡ä»¶è®°å½•
- `getAllPieceWorkRecords()` - è·å–æ‰€æœ‰è®¡ä»¶è®°å½•

**RLS ç­–ç•¥**ï¼š
```sql
-- ç”¨æˆ·å¯ä»¥æŸ¥çœ‹è‡ªå·±çš„è®¡ä»¶è®°å½•
CREATE POLICY "Users can view own piece work records" ON piece_work_records
  FOR SELECT TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND (user_id = auth.uid()));

-- ç®¡ç†å‘˜å¯ä»¥æŸ¥çœ‹ç§Ÿæˆ·çš„è®¡ä»¶è®°å½•
CREATE POLICY "Manager can view tenant piece work records" ON piece_work_records
  FOR SELECT TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND (is_admin(auth.uid()) OR is_super_admin(auth.uid())));

-- è€æ¿å¯ä»¥ç®¡ç†ç§Ÿæˆ·çš„è®¡ä»¶è®°å½•
CREATE POLICY "Super admin can manage tenant piece work records" ON piece_work_records
  FOR ALL TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND is_super_admin(auth.uid()))
  WITH CHECK ((boss_id = get_current_user_boss_id()) AND is_super_admin(auth.uid()));
```

**æ•ˆæœ**ï¼š
- âœ… æ•°æ®åº“å±‚é¢è‡ªåŠ¨è¿‡æ»¤ `boss_id`
- âœ… ç”¨æˆ·åªèƒ½æŸ¥è¯¢è‡ªå·±ç§Ÿæˆ·çš„è®¡ä»¶è®°å½•
- âœ… å¸æœºåªèƒ½æŸ¥çœ‹è‡ªå·±çš„è®¡ä»¶è®°å½•
- âœ… ç®¡ç†å‘˜å¯ä»¥æŸ¥çœ‹æ‰€æœ‰å¸æœºçš„è®¡ä»¶è®°å½•

#### 2. æ›´æ–°å’Œåˆ é™¤è®¡ä»¶è®°å½• - âœ… ä¾èµ– RLS ç­–ç•¥
**å‡½æ•°**ï¼š
- `updatePieceWorkRecord(id, record)` - æ›´æ–°è®¡ä»¶è®°å½•
- `deletePieceWorkRecord(id)` - åˆ é™¤è®¡ä»¶è®°å½•

**RLS ç­–ç•¥**ï¼š
```sql
-- ç”¨æˆ·å¯ä»¥æ›´æ–°è‡ªå·±çš„è®¡ä»¶è®°å½•
CREATE POLICY "Users can update own piece work records" ON piece_work_records
  FOR UPDATE TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND (user_id = auth.uid()))
  WITH CHECK ((boss_id = get_current_user_boss_id()) AND (user_id = auth.uid()));

-- ç”¨æˆ·å¯ä»¥åˆ é™¤è‡ªå·±çš„è®¡ä»¶è®°å½•
CREATE POLICY "Users can delete own piece work records" ON piece_work_records
  FOR DELETE TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND (user_id = auth.uid()));

-- ç®¡ç†å‘˜å¯ä»¥æ›´æ–°ç§Ÿæˆ·çš„è®¡ä»¶è®°å½•
CREATE POLICY "Manager can update tenant piece work records" ON piece_work_records
  FOR UPDATE TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND (is_admin(auth.uid()) OR is_super_admin(auth.uid())))
  WITH CHECK ((boss_id = get_current_user_boss_id()) AND (is_admin(auth.uid()) OR is_super_admin(auth.uid())));

-- ç®¡ç†å‘˜å¯ä»¥åˆ é™¤ç§Ÿæˆ·çš„è®¡ä»¶è®°å½•
CREATE POLICY "Manager can delete tenant piece work records" ON piece_work_records
  FOR DELETE TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND (is_admin(auth.uid()) OR is_super_admin(auth.uid())));
```

**æ•ˆæœ**ï¼š
- âœ… RLS ç­–ç•¥é˜»æ­¢è·¨ç§Ÿæˆ·æ“ä½œ
- âœ… åªèƒ½æ›´æ–°/åˆ é™¤è‡ªå·±ç§Ÿæˆ·çš„è®¡ä»¶è®°å½•

#### 3. æŸ¥è¯¢ä»·æ ¼é…ç½® - âœ… ä¾èµ– RLS ç­–ç•¥
**å‡½æ•°**ï¼š
- `getCategoryPricesByWarehouse(warehouseId)` - è·å–ä»“åº“çš„ä»·æ ¼é…ç½®
- `getCategoryPrice(warehouseId, categoryName)` - è·å–ç‰¹å®šå“ç±»çš„ä»·æ ¼
- `getCategoryPriceForDriver(driverId, warehouseId, categoryName)` - è·å–å¸æœºçš„ä»·æ ¼

**RLS ç­–ç•¥**ï¼š
```sql
-- ç”¨æˆ·å¯ä»¥æŸ¥çœ‹ç§Ÿæˆ·çš„ä»·æ ¼é…ç½®
CREATE POLICY "Users can view tenant category prices" ON category_prices
  FOR SELECT TO authenticated
  USING (boss_id = get_current_user_boss_id());

-- è€æ¿å¯ä»¥ç®¡ç†ç§Ÿæˆ·çš„ä»·æ ¼é…ç½®
CREATE POLICY "Super admin can manage tenant category prices" ON category_prices
  FOR ALL TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND is_super_admin(auth.uid()))
  WITH CHECK ((boss_id = get_current_user_boss_id()) AND is_super_admin(auth.uid()));
```

**æ•ˆæœ**ï¼š
- âœ… æ•°æ®åº“å±‚é¢è‡ªåŠ¨è¿‡æ»¤ `boss_id`
- âœ… ç”¨æˆ·åªèƒ½æŸ¥è¯¢è‡ªå·±ç§Ÿæˆ·çš„ä»·æ ¼é…ç½®

#### 4. è®¡ä»¶ç»Ÿè®¡ - âœ… ä¾èµ– RLS ç­–ç•¥
**å‡½æ•°**ï¼š
- `calculatePieceWorkStats(userId, year, month)` - è®¡ç®—è®¡ä»¶ç»Ÿè®¡

**æ•ˆæœ**ï¼š
- âœ… RLS ç­–ç•¥è‡ªåŠ¨è¿‡æ»¤ç§Ÿæˆ·æ•°æ®
- âœ… åªèƒ½æŸ¥è¯¢è‡ªå·±ç§Ÿæˆ·çš„ç»Ÿè®¡æ•°æ®

### âŒ éœ€è¦ä¿®å¤çš„åŠŸèƒ½

#### é—®é¢˜ 1ï¼šåˆ›å»ºè®¡ä»¶è®°å½•ç¼ºå°‘ boss_id

**å‡½æ•°**ï¼š`createPieceWorkRecord`  
**å½“å‰ä»£ç **ï¼š
```typescript
export async function createPieceWorkRecord(record: PieceWorkRecordInput): Promise<boolean> {
  const {error} = await supabase
    .from('piece_work_records')
    .insert(record)  // âŒ ç›´æ¥æ’å…¥ recordï¼Œæ²¡æœ‰æ·»åŠ  boss_id

  if (error) {
    console.error('åˆ›å»ºè®¡ä»¶è®°å½•å¤±è´¥:', error)
    return false
  }

  return true
}
```

**é—®é¢˜**ï¼š
- âŒ æ’å…¥æ—¶æ²¡æœ‰æ·»åŠ  `boss_id` å­—æ®µ
- âŒ RLS ç­–ç•¥çš„ `WITH CHECK` æ¡ä»¶è¦æ±‚ `boss_id = get_current_user_boss_id()`
- âŒ ä¼šå¯¼è‡´åˆ›å»ºè®¡ä»¶è®°å½•å¤±è´¥

**RLS ç­–ç•¥**ï¼š
```sql
-- ç”¨æˆ·å¯ä»¥åˆ›å»ºè‡ªå·±çš„è®¡ä»¶è®°å½•
CREATE POLICY "Users can create own piece work records" ON piece_work_records
  FOR INSERT TO authenticated
  WITH CHECK ((boss_id = get_current_user_boss_id()) AND (user_id = auth.uid()));

-- ç®¡ç†å‘˜å¯ä»¥åˆ›å»ºç§Ÿæˆ·çš„è®¡ä»¶è®°å½•
CREATE POLICY "Manager can create tenant piece work records" ON piece_work_records
  FOR INSERT TO authenticated
  WITH CHECK ((boss_id = get_current_user_boss_id()) AND (is_admin(auth.uid()) OR is_super_admin(auth.uid())));
```

**å½±å“**ï¼š
- å¸æœºæ— æ³•åˆ›å»ºè®¡ä»¶è®°å½•
- ç®¡ç†å‘˜æ— æ³•ä¸ºå¸æœºåˆ›å»ºè®¡ä»¶è®°å½•
- è€æ¿æ— æ³•ä¸ºå¸æœºåˆ›å»ºè®¡ä»¶è®°å½•
- è¿™æ˜¯ä¸€ä¸ª**ä¸¥é‡çš„é—®é¢˜**ï¼Œä¼šå¯¼è‡´è®¡ä»¶ç®¡ç†åŠŸèƒ½å®Œå…¨æ— æ³•ä½¿ç”¨

#### é—®é¢˜ 2ï¼šåˆ›å»º/æ›´æ–°ä»·æ ¼é…ç½®ç¼ºå°‘ boss_id

**å‡½æ•°**ï¼š`upsertCategoryPrice`  
**å½“å‰ä»£ç **ï¼š
```typescript
export async function upsertCategoryPrice(input: CategoryPriceInput): Promise<boolean> {
  const {error} = await supabase
    .from('category_prices')
    .upsert(
      {
        warehouse_id: input.warehouse_id,
        category_name: input.category_name,
        unit_price: input.unit_price,
        upstairs_price: input.upstairs_price,
        sorting_unit_price: input.sorting_unit_price,
        is_active: input.is_active ?? true
        // âŒ ç¼ºå°‘ boss_id å’Œ tenant_id
      },
      {
        onConflict: 'warehouse_id,category_name'
      }
    )

  if (error) {
    console.error('ä¿å­˜å“ç±»ä»·æ ¼é…ç½®å¤±è´¥:', error)
    return false
  }

  return true
}
```

**é—®é¢˜**ï¼š
- âŒ æ’å…¥æ—¶æ²¡æœ‰æ·»åŠ  `boss_id` å­—æ®µ
- âŒ RLS ç­–ç•¥çš„ `WITH CHECK` æ¡ä»¶è¦æ±‚ `boss_id = get_current_user_boss_id()`
- âŒ ä¼šå¯¼è‡´åˆ›å»º/æ›´æ–°ä»·æ ¼é…ç½®å¤±è´¥

**RLS ç­–ç•¥**ï¼š
```sql
-- è€æ¿å¯ä»¥ç®¡ç†ç§Ÿæˆ·çš„ä»·æ ¼é…ç½®
CREATE POLICY "Super admin can manage tenant category prices" ON category_prices
  FOR ALL TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND is_super_admin(auth.uid()))
  WITH CHECK ((boss_id = get_current_user_boss_id()) AND is_super_admin(auth.uid()));

-- ç®¡ç†å‘˜å¯ä»¥ä¸ºè‡ªå·±ç®¡ç†çš„ä»“åº“æ’å…¥ä»·æ ¼é…ç½®
CREATE POLICY "Managers can insert category prices for their warehouses" ON category_prices
  FOR INSERT TO authenticated
  WITH CHECK (is_manager(auth.uid()) AND (warehouse_id IN (
    SELECT manager_warehouses.warehouse_id
    FROM manager_warehouses
    WHERE (manager_warehouses.manager_id = auth.uid())
  )));
```

**å½±å“**ï¼š
- è€æ¿æ— æ³•è®¾ç½®ä»·æ ¼é…ç½®
- ç®¡ç†å‘˜æ— æ³•è®¾ç½®ä»·æ ¼é…ç½®
- è¿™æ˜¯ä¸€ä¸ª**ä¸¥é‡çš„é—®é¢˜**ï¼Œä¼šå¯¼è‡´ä»·æ ¼ç®¡ç†åŠŸèƒ½å®Œå…¨æ— æ³•ä½¿ç”¨

#### é—®é¢˜ 3ï¼šæ‰¹é‡åˆ›å»º/æ›´æ–°ä»·æ ¼é…ç½®ç¼ºå°‘ boss_id

**å‡½æ•°**ï¼š`batchUpsertCategoryPrices`  
**å½“å‰ä»£ç **ï¼š
```typescript
export async function batchUpsertCategoryPrices(inputs: CategoryPriceInput[]): Promise<boolean> {
  const {error} = await supabase
    .from('category_prices')
    .upsert(
      inputs.map((input) => ({
        warehouse_id: input.warehouse_id,
        category_name: input.category_name,
        unit_price: input.unit_price,
        upstairs_price: input.upstairs_price,
        sorting_unit_price: input.sorting_unit_price,
        is_active: input.is_active ?? true
        // âŒ ç¼ºå°‘ boss_id å’Œ tenant_id
      })),
      {
        onConflict: 'warehouse_id,category_name'
      }
    )

  if (error) {
    console.error('æ‰¹é‡ä¿å­˜å“ç±»ä»·æ ¼é…ç½®å¤±è´¥:', error)
    return false
  }

  return true
}
```

**é—®é¢˜**ï¼š
- âŒ æ’å…¥æ—¶æ²¡æœ‰æ·»åŠ  `boss_id` å­—æ®µ
- âŒ RLS ç­–ç•¥çš„ `WITH CHECK` æ¡ä»¶è¦æ±‚ `boss_id = get_current_user_boss_id()`
- âŒ ä¼šå¯¼è‡´æ‰¹é‡åˆ›å»º/æ›´æ–°ä»·æ ¼é…ç½®å¤±è´¥

**å½±å“**ï¼š
- è€æ¿æ— æ³•æ‰¹é‡è®¾ç½®ä»·æ ¼é…ç½®
- ç®¡ç†å‘˜æ— æ³•æ‰¹é‡è®¾ç½®ä»·æ ¼é…ç½®

## ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

### ä¿®å¤ 1ï¼šä¿®æ”¹ createPieceWorkRecord å‡½æ•°

**ä¿®æ”¹æ–‡ä»¶**ï¼š`src/db/api.ts`

**ä¿®å¤åçš„ä»£ç **ï¼š
```typescript
export async function createPieceWorkRecord(record: PieceWorkRecordInput): Promise<boolean> {
  // 1. è·å–å½“å‰ç”¨æˆ·
  const {
    data: {user}
  } = await supabase.auth.getUser()

  if (!user) {
    console.error('åˆ›å»ºè®¡ä»¶è®°å½•å¤±è´¥: ç”¨æˆ·æœªç™»å½•')
    return false
  }

  // 2. è·å–å½“å‰ç”¨æˆ·çš„ boss_id
  const {data: profile} = await supabase
    .from('profiles')
    .select('boss_id')
    .eq('id', user.id)
    .maybeSingle()

  if (!profile?.boss_id) {
    console.error('åˆ›å»ºè®¡ä»¶è®°å½•å¤±è´¥: æ— æ³•è·å– boss_id')
    return false
  }

  // 3. æ’å…¥è®¡ä»¶è®°å½•ï¼ˆè‡ªåŠ¨æ·»åŠ  boss_id å’Œ tenant_idï¼‰
  const {error} = await supabase
    .from('piece_work_records')
    .insert({
      ...record,
      boss_id: profile.boss_id,
      tenant_id: profile.boss_id
    })

  if (error) {
    console.error('åˆ›å»ºè®¡ä»¶è®°å½•å¤±è´¥:', error)
    return false
  }

  return true
}
```

### ä¿®å¤ 2ï¼šä¿®æ”¹ upsertCategoryPrice å‡½æ•°

**ä¿®æ”¹æ–‡ä»¶**ï¼š`src/db/api.ts`

**ä¿®å¤åçš„ä»£ç **ï¼š
```typescript
export async function upsertCategoryPrice(input: CategoryPriceInput): Promise<boolean> {
  // 1. è·å–å½“å‰ç”¨æˆ·
  const {
    data: {user}
  } = await supabase.auth.getUser()

  if (!user) {
    console.error('ä¿å­˜å“ç±»ä»·æ ¼é…ç½®å¤±è´¥: ç”¨æˆ·æœªç™»å½•')
    return false
  }

  // 2. è·å–å½“å‰ç”¨æˆ·çš„ boss_id
  const {data: profile} = await supabase
    .from('profiles')
    .select('boss_id')
    .eq('id', user.id)
    .maybeSingle()

  if (!profile?.boss_id) {
    console.error('ä¿å­˜å“ç±»ä»·æ ¼é…ç½®å¤±è´¥: æ— æ³•è·å– boss_id')
    return false
  }

  // 3. æ’å…¥/æ›´æ–°ä»·æ ¼é…ç½®ï¼ˆè‡ªåŠ¨æ·»åŠ  boss_id å’Œ tenant_idï¼‰
  const {error} = await supabase
    .from('category_prices')
    .upsert(
      {
        warehouse_id: input.warehouse_id,
        category_name: input.category_name,
        unit_price: input.unit_price,
        upstairs_price: input.upstairs_price,
        sorting_unit_price: input.sorting_unit_price,
        is_active: input.is_active ?? true,
        boss_id: profile.boss_id,
        tenant_id: profile.boss_id
      },
      {
        onConflict: 'warehouse_id,category_name'
      }
    )

  if (error) {
    console.error('ä¿å­˜å“ç±»ä»·æ ¼é…ç½®å¤±è´¥:', error)
    return false
  }

  return true
}
```

### ä¿®å¤ 3ï¼šä¿®æ”¹ batchUpsertCategoryPrices å‡½æ•°

**ä¿®æ”¹æ–‡ä»¶**ï¼š`src/db/api.ts`

**ä¿®å¤åçš„ä»£ç **ï¼š
```typescript
export async function batchUpsertCategoryPrices(inputs: CategoryPriceInput[]): Promise<boolean> {
  // 1. è·å–å½“å‰ç”¨æˆ·
  const {
    data: {user}
  } = await supabase.auth.getUser()

  if (!user) {
    console.error('æ‰¹é‡ä¿å­˜å“ç±»ä»·æ ¼é…ç½®å¤±è´¥: ç”¨æˆ·æœªç™»å½•')
    return false
  }

  // 2. è·å–å½“å‰ç”¨æˆ·çš„ boss_id
  const {data: profile} = await supabase
    .from('profiles')
    .select('boss_id')
    .eq('id', user.id)
    .maybeSingle()

  if (!profile?.boss_id) {
    console.error('æ‰¹é‡ä¿å­˜å“ç±»ä»·æ ¼é…ç½®å¤±è´¥: æ— æ³•è·å– boss_id')
    return false
  }

  // 3. æ‰¹é‡æ’å…¥/æ›´æ–°ä»·æ ¼é…ç½®ï¼ˆè‡ªåŠ¨æ·»åŠ  boss_id å’Œ tenant_idï¼‰
  const {error} = await supabase
    .from('category_prices')
    .upsert(
      inputs.map((input) => ({
        warehouse_id: input.warehouse_id,
        category_name: input.category_name,
        unit_price: input.unit_price,
        upstairs_price: input.upstairs_price,
        sorting_unit_price: input.sorting_unit_price,
        is_active: input.is_active ?? true,
        boss_id: profile.boss_id,
        tenant_id: profile.boss_id
      })),
      {
        onConflict: 'warehouse_id,category_name'
      }
    )

  if (error) {
    console.error('æ‰¹é‡ä¿å­˜å“ç±»ä»·æ ¼é…ç½®å¤±è´¥:', error)
    return false
  }

  return true
}
```

## ğŸ“Š å¤šç§Ÿæˆ·æ¶æ„éªŒè¯

### æ•°æ®éš”ç¦»ä¿è¯

#### 1. è®¡ä»¶è®°å½•æ•°æ®éš”ç¦»
```typescript
// ç§Ÿæˆ· A çš„å¸æœºç™»å½•
const records = await getPieceWorkRecordsByUser(userId, year, month)
// âœ… åªè¿”å›ç§Ÿæˆ· A çš„è®¡ä»¶è®°å½•

// ç§Ÿæˆ· B çš„å¸æœºç™»å½•
const records = await getPieceWorkRecordsByUser(userId, year, month)
// âœ… åªè¿”å›ç§Ÿæˆ· B çš„è®¡ä»¶è®°å½•
```

#### 2. ä»·æ ¼é…ç½®æ•°æ®éš”ç¦»
```typescript
// ç§Ÿæˆ· A çš„è€æ¿ç™»å½•
const prices = await getCategoryPricesByWarehouse(warehouseId)
// âœ… åªè¿”å›ç§Ÿæˆ· A çš„ä»·æ ¼é…ç½®

// ç§Ÿæˆ· B çš„è€æ¿ç™»å½•
const prices = await getCategoryPricesByWarehouse(warehouseId)
// âœ… åªè¿”å›ç§Ÿæˆ· B çš„ä»·æ ¼é…ç½®
```

#### 3. è®¡ä»¶ç»Ÿè®¡æ•°æ®éš”ç¦»
```typescript
// ç§Ÿæˆ· A çš„è€æ¿ç™»å½•
const stats = await calculatePieceWorkStats(userId, year, month)
// âœ… åªè¿”å›ç§Ÿæˆ· A çš„ç»Ÿè®¡æ•°æ®

// ç§Ÿæˆ· B çš„è€æ¿ç™»å½•
const stats = await calculatePieceWorkStats(userId, year, month)
// âœ… åªè¿”å›ç§Ÿæˆ· B çš„ç»Ÿè®¡æ•°æ®
```

### RLS ç­–ç•¥å·¥ä½œåŸç†

```
ç”¨æˆ·è¯·æ±‚ â†’ Supabase Client â†’ Supabase Server
                                    â†“
                            åº”ç”¨ RLS ç­–ç•¥
                                    â†“
                            è¿‡æ»¤ boss_id
                                    â†“
                            è¿”å›ç§Ÿæˆ·æ•°æ®
```

**å…³é”®ç‚¹**ï¼š
1. RLS ç­–ç•¥åœ¨æ•°æ®åº“å±‚é¢æ‰§è¡Œï¼Œæ— æ³•ç»•è¿‡
2. å³ä½¿åº”ç”¨å±‚ä»£ç æœ‰æ¼æ´ï¼Œæ•°æ®åº“ä¹Ÿä¼šç¡®ä¿ç§Ÿæˆ·éš”ç¦»
3. æ‰€æœ‰æŸ¥è¯¢éƒ½ä¼šè‡ªåŠ¨æ·»åŠ  `WHERE boss_id = get_current_user_boss_id()` æ¡ä»¶
4. æ‰€æœ‰æ’å…¥éƒ½ä¼šæ£€æŸ¥ `boss_id = get_current_user_boss_id()` æ¡ä»¶

## ğŸ“ˆ æ£€æŸ¥æ€»ç»“

### å·²æ£€æŸ¥çš„è¡¨

| è¡¨å | boss_id å­—æ®µ | RLS ç­–ç•¥ | åˆ›å»ºå‡½æ•° | æŸ¥è¯¢å‡½æ•° | æ›´æ–°å‡½æ•° | åˆ é™¤å‡½æ•° |
|------|-------------|---------|---------|---------|---------|---------|
| piece_work_records | âœ… | âœ… | âŒ éœ€ä¿®å¤ | âœ… | âœ… | âœ… |
| category_prices | âœ… | âœ… | âŒ éœ€ä¿®å¤ | âœ… | âœ… | âœ… |

### å·²æ£€æŸ¥çš„åŠŸèƒ½æ¨¡å—

| åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | è¯´æ˜ |
|---------|------|------|
| è®¡ä»¶è®°å½• CRUD | âŒ | åˆ›å»ºå‡½æ•°éœ€è¦ä¿®å¤ï¼Œå…¶ä»–å·²æ­£ç¡®é€‚é… |
| ä»·æ ¼é…ç½® CRUD | âŒ | åˆ›å»º/æ›´æ–°å‡½æ•°éœ€è¦ä¿®å¤ï¼Œå…¶ä»–å·²æ­£ç¡®é€‚é… |
| è®¡ä»¶ç»Ÿè®¡ | âœ… | ä¾èµ– RLS ç­–ç•¥ï¼Œè‡ªåŠ¨éš”ç¦» |

### éœ€è¦ä¿®å¤çš„é—®é¢˜

1. **é«˜ä¼˜å…ˆçº§**ï¼š
   - âŒ `createPieceWorkRecord` å‡½æ•°ç¼ºå°‘ `boss_id` å’Œ `tenant_id`ï¼ˆ**ä¸¥é‡é—®é¢˜**ï¼‰
   - âŒ `upsertCategoryPrice` å‡½æ•°ç¼ºå°‘ `boss_id` å’Œ `tenant_id`ï¼ˆ**ä¸¥é‡é—®é¢˜**ï¼‰
   - âŒ `batchUpsertCategoryPrices` å‡½æ•°ç¼ºå°‘ `boss_id` å’Œ `tenant_id`ï¼ˆ**ä¸¥é‡é—®é¢˜**ï¼‰

2. **ä½ä¼˜å…ˆçº§**ï¼š
   - æ— 

### ä¿®å¤åçš„æ•ˆæœ

- âœ… æ‰€æœ‰è®¡ä»¶ç®¡ç†åŠŸèƒ½éƒ½æ­£ç¡®é€‚é…å¤šç§Ÿæˆ·æ¶æ„
- âœ… æ¯ä¸ªç§Ÿæˆ·çš„æ•°æ®å®Œå…¨éš”ç¦»
- âœ… æ— æ³•è·¨ç§Ÿæˆ·è®¿é—®æˆ–æ“ä½œæ•°æ®
- âœ… å¸æœºå¯ä»¥æ­£å¸¸åˆ›å»ºè®¡ä»¶è®°å½•
- âœ… ç®¡ç†å‘˜å¯ä»¥æ­£å¸¸åˆ›å»ºè®¡ä»¶è®°å½•
- âœ… è€æ¿å¯ä»¥æ­£å¸¸è®¾ç½®ä»·æ ¼é…ç½®
- âœ… æ•°æ®åº“å±‚é¢å’Œåº”ç”¨å±‚é¢åŒé‡ä¿æŠ¤

## ğŸ§ª æµ‹è¯•å»ºè®®

### æµ‹è¯•åœºæ™¯ 1ï¼šåˆ›å»ºè®¡ä»¶è®°å½•
1. ä½¿ç”¨ç§Ÿæˆ· A çš„å¸æœºè´¦å·ç™»å½•
2. è¿›å…¥è®¡ä»¶ç®¡ç†é¡µé¢
3. åˆ›å»ºä¸€æ¡è®¡ä»¶è®°å½•
4. **é¢„æœŸç»“æœ**ï¼šâœ… åˆ›å»ºæˆåŠŸï¼Œä¸ä¼šå‡ºç°æƒé™é”™è¯¯

### æµ‹è¯•åœºæ™¯ 2ï¼šéªŒè¯è®¡ä»¶è®°å½•éš”ç¦»
1. ä½¿ç”¨ç§Ÿæˆ· A çš„å¸æœºè´¦å·ç™»å½•
2. åˆ›å»ºä¸€æ¡è®¡ä»¶è®°å½•
3. é€€å‡ºç™»å½•
4. ä½¿ç”¨ç§Ÿæˆ· B çš„è€æ¿è´¦å·ç™»å½•
5. æŸ¥è¯¢è®¡ä»¶è®°å½•åˆ—è¡¨
6. **é¢„æœŸç»“æœ**ï¼šâœ… çœ‹ä¸åˆ°ç§Ÿæˆ· A çš„è®¡ä»¶è®°å½•

### æµ‹è¯•åœºæ™¯ 3ï¼šè®¾ç½®ä»·æ ¼é…ç½®
1. ä½¿ç”¨ç§Ÿæˆ· A çš„è€æ¿è´¦å·ç™»å½•
2. è¿›å…¥ä»·æ ¼ç®¡ç†é¡µé¢
3. è®¾ç½®æŸä¸ªå“ç±»çš„ä»·æ ¼
4. **é¢„æœŸç»“æœ**ï¼šâœ… è®¾ç½®æˆåŠŸï¼Œä¸ä¼šå‡ºç°æƒé™é”™è¯¯

### æµ‹è¯•åœºæ™¯ 4ï¼šéªŒè¯ä»·æ ¼é…ç½®éš”ç¦»
1. ä½¿ç”¨ç§Ÿæˆ· A çš„è€æ¿è´¦å·ç™»å½•
2. è®¾ç½®ä»·æ ¼é…ç½®
3. é€€å‡ºç™»å½•
4. ä½¿ç”¨ç§Ÿæˆ· B çš„è€æ¿è´¦å·ç™»å½•
5. æŸ¥è¯¢ä»·æ ¼é…ç½®åˆ—è¡¨
6. **é¢„æœŸç»“æœ**ï¼šâœ… çœ‹ä¸åˆ°ç§Ÿæˆ· A çš„ä»·æ ¼é…ç½®

### æµ‹è¯•åœºæ™¯ 5ï¼šéªŒè¯è·¨ç§Ÿæˆ·æ“ä½œè¢«é˜»æ­¢
1. ä½¿ç”¨ç§Ÿæˆ· A çš„è€æ¿è´¦å·ç™»å½•
2. è·å–ç§Ÿæˆ· B çš„æŸä¸ªè®¡ä»¶è®°å½• ID
3. å°è¯•æ›´æ–°è¯¥è®¡ä»¶è®°å½•
4. **é¢„æœŸç»“æœ**ï¼šâœ… æ›´æ–°å¤±è´¥ï¼ŒRLS ç­–ç•¥é˜»æ­¢æ“ä½œ

## ğŸ“ æŠ€æœ¯ç»†èŠ‚

### æ•°æ®åº“è¡¨ç»“æ„

#### piece_work_records è¡¨
```sql
CREATE TABLE piece_work_records (
  id uuid PRIMARY KEY,
  user_id uuid NOT NULL REFERENCES profiles(id),
  warehouse_id uuid NOT NULL REFERENCES warehouses(id),
  category_id uuid,
  work_date date NOT NULL,
  quantity integer NOT NULL,
  unit_price numeric NOT NULL,
  total_amount numeric NOT NULL,
  need_upstairs boolean NOT NULL,
  upstairs_price numeric NOT NULL,
  need_sorting boolean NOT NULL,
  sorting_quantity integer NOT NULL,
  sorting_unit_price numeric NOT NULL,
  notes text,
  boss_id text NOT NULL,      -- ç§Ÿæˆ· ID
  tenant_id uuid,              -- ç§Ÿæˆ· IDï¼ˆä¸ boss_id ç›¸åŒï¼‰
  created_at timestamptz DEFAULT now(),
  updated_at timestamptz DEFAULT now()
);
```

#### category_prices è¡¨
```sql
CREATE TABLE category_prices (
  id uuid PRIMARY KEY,
  warehouse_id uuid NOT NULL REFERENCES warehouses(id),
  category_name text NOT NULL,
  unit_price numeric NOT NULL,
  upstairs_price numeric NOT NULL,
  sorting_unit_price numeric NOT NULL,
  is_active boolean NOT NULL,
  boss_id text NOT NULL,      -- ç§Ÿæˆ· ID
  tenant_id uuid,              -- ç§Ÿæˆ· IDï¼ˆä¸ boss_id ç›¸åŒï¼‰
  created_at timestamptz DEFAULT now(),
  updated_at timestamptz DEFAULT now(),
  UNIQUE(warehouse_id, category_name)
);
```

### RLS ç­–ç•¥

#### piece_work_records è¡¨ç­–ç•¥
```sql
-- ç”¨æˆ·å¯ä»¥åˆ›å»ºè‡ªå·±çš„è®¡ä»¶è®°å½•
CREATE POLICY "Users can create own piece work records" ON piece_work_records
  FOR INSERT TO authenticated
  WITH CHECK ((boss_id = get_current_user_boss_id()) AND (user_id = auth.uid()));

-- ç”¨æˆ·å¯ä»¥æŸ¥çœ‹è‡ªå·±çš„è®¡ä»¶è®°å½•
CREATE POLICY "Users can view own piece work records" ON piece_work_records
  FOR SELECT TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND (user_id = auth.uid()));

-- ç”¨æˆ·å¯ä»¥æ›´æ–°è‡ªå·±çš„è®¡ä»¶è®°å½•
CREATE POLICY "Users can update own piece work records" ON piece_work_records
  FOR UPDATE TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND (user_id = auth.uid()))
  WITH CHECK ((boss_id = get_current_user_boss_id()) AND (user_id = auth.uid()));

-- ç”¨æˆ·å¯ä»¥åˆ é™¤è‡ªå·±çš„è®¡ä»¶è®°å½•
CREATE POLICY "Users can delete own piece work records" ON piece_work_records
  FOR DELETE TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND (user_id = auth.uid()));

-- ç®¡ç†å‘˜å¯ä»¥ç®¡ç†ç§Ÿæˆ·çš„è®¡ä»¶è®°å½•
CREATE POLICY "Manager can create tenant piece work records" ON piece_work_records
  FOR INSERT TO authenticated
  WITH CHECK ((boss_id = get_current_user_boss_id()) AND (is_admin(auth.uid()) OR is_super_admin(auth.uid())));

CREATE POLICY "Manager can view tenant piece work records" ON piece_work_records
  FOR SELECT TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND (is_admin(auth.uid()) OR is_super_admin(auth.uid())));

CREATE POLICY "Manager can update tenant piece work records" ON piece_work_records
  FOR UPDATE TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND (is_admin(auth.uid()) OR is_super_admin(auth.uid())))
  WITH CHECK ((boss_id = get_current_user_boss_id()) AND (is_admin(auth.uid()) OR is_super_admin(auth.uid())));

CREATE POLICY "Manager can delete tenant piece work records" ON piece_work_records
  FOR DELETE TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND (is_admin(auth.uid()) OR is_super_admin(auth.uid())));

-- è€æ¿å¯ä»¥ç®¡ç†ç§Ÿæˆ·çš„æ‰€æœ‰è®¡ä»¶è®°å½•
CREATE POLICY "Super admin can manage tenant piece work records" ON piece_work_records
  FOR ALL TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND is_super_admin(auth.uid()))
  WITH CHECK ((boss_id = get_current_user_boss_id()) AND is_super_admin(auth.uid()));
```

#### category_prices è¡¨ç­–ç•¥
```sql
-- ç”¨æˆ·å¯ä»¥æŸ¥çœ‹ç§Ÿæˆ·çš„ä»·æ ¼é…ç½®
CREATE POLICY "Users can view tenant category prices" ON category_prices
  FOR SELECT TO authenticated
  USING (boss_id = get_current_user_boss_id());

-- è€æ¿å¯ä»¥ç®¡ç†ç§Ÿæˆ·çš„ä»·æ ¼é…ç½®
CREATE POLICY "Super admin can manage tenant category prices" ON category_prices
  FOR ALL TO authenticated
  USING ((boss_id = get_current_user_boss_id()) AND is_super_admin(auth.uid()))
  WITH CHECK ((boss_id = get_current_user_boss_id()) AND is_super_admin(auth.uid()));

-- ç®¡ç†å‘˜å¯ä»¥ä¸ºè‡ªå·±ç®¡ç†çš„ä»“åº“æ’å…¥ä»·æ ¼é…ç½®
CREATE POLICY "Managers can insert category prices for their warehouses" ON category_prices
  FOR INSERT TO authenticated
  WITH CHECK (is_manager(auth.uid()) AND (warehouse_id IN (
    SELECT manager_warehouses.warehouse_id
    FROM manager_warehouses
    WHERE (manager_warehouses.manager_id = auth.uid())
  )));

-- ç®¡ç†å‘˜å¯ä»¥ä¸ºè‡ªå·±ç®¡ç†çš„ä»“åº“æ›´æ–°ä»·æ ¼é…ç½®
CREATE POLICY "Managers can update category prices for their warehouses" ON category_prices
  FOR UPDATE TO authenticated
  USING (is_manager(auth.uid()) AND (warehouse_id IN (
    SELECT manager_warehouses.warehouse_id
    FROM manager_warehouses
    WHERE (manager_warehouses.manager_id = auth.uid())
  )))
  WITH CHECK (is_manager(auth.uid()) AND (warehouse_id IN (
    SELECT manager_warehouses.warehouse_id
    FROM manager_warehouses
    WHERE (manager_warehouses.manager_id = auth.uid())
  )));

-- ç®¡ç†å‘˜å¯ä»¥ä¸ºè‡ªå·±ç®¡ç†çš„ä»“åº“åˆ é™¤ä»·æ ¼é…ç½®
CREATE POLICY "Managers can delete category prices for their warehouses" ON category_prices
  FOR DELETE TO authenticated
  USING (is_manager(auth.uid()) AND (warehouse_id IN (
    SELECT manager_warehouses.warehouse_id
    FROM manager_warehouses
    WHERE (manager_warehouses.manager_id = auth.uid())
  )));
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. boss_id çš„è·å–
- æ‰€æœ‰åˆ›å»ºå‡½æ•°éƒ½ä¼šè‡ªåŠ¨ä»å½“å‰ç™»å½•ç”¨æˆ·çš„ profile ä¸­è·å– `boss_id`
- å¦‚æœç”¨æˆ·æœªç™»å½•æˆ–æ— æ³•è·å– `boss_id`ï¼Œåˆ›å»ºä¼šå¤±è´¥

### 2. tenant_id çš„è®¾ç½®
- `tenant_id` å­—æ®µè®¾ç½®ä¸ºä¸ `boss_id` ç›¸åŒçš„å€¼
- è¿™æ˜¯å› ä¸ºåœ¨å½“å‰ç³»ç»Ÿä¸­ï¼Œç§Ÿæˆ· ID å°±æ˜¯è€æ¿çš„ ID

### 3. RLS ç­–ç•¥çš„ä½œç”¨
- RLS ç­–ç•¥åœ¨æ•°æ®åº“å±‚é¢æ‰§è¡Œï¼Œæ— æ³•ç»•è¿‡
- å³ä½¿åº”ç”¨å±‚ä»£ç æœ‰æ¼æ´ï¼Œæ•°æ®åº“ä¹Ÿä¼šç¡®ä¿ç§Ÿæˆ·éš”ç¦»
- æ‰€æœ‰æŸ¥è¯¢éƒ½ä¼šè‡ªåŠ¨æ·»åŠ  `WHERE boss_id = get_current_user_boss_id()` æ¡ä»¶

### 4. å¤–é”®å…³è”
- `piece_work_records.user_id` å¼•ç”¨ `profiles.id`
- `piece_work_records.warehouse_id` å¼•ç”¨ `warehouses.id`
- `category_prices.warehouse_id` å¼•ç”¨ `warehouses.id`
- ç”±äºæ‰€æœ‰è¡¨éƒ½æœ‰ `boss_id` è¿‡æ»¤ï¼Œè®¡ä»¶è®°å½•åªèƒ½å…³è”åˆ°åŒä¸€ç§Ÿæˆ·çš„ç”¨æˆ·å’Œä»“åº“
- è¿™ç¡®ä¿äº†æ•°æ®çš„ä¸€è‡´æ€§å’Œéš”ç¦»æ€§

### 5. è®¡ä»¶åŠŸèƒ½çš„ç‰¹æ®Šæ€§
- è®¡ä»¶åŠŸèƒ½æ˜¯å¸æœºçš„æ ¸å¿ƒåŠŸèƒ½
- å¿…é¡»ç¡®ä¿è®¡ä»¶åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- è®¡ä»¶å¤±è´¥ä¼šä¸¥é‡å½±å“ç”¨æˆ·ä½“éªŒå’Œå·¥èµ„ç»“ç®—

## ğŸ“ˆ ä¿®å¤è¿›åº¦

- [x] æ£€æŸ¥è®¡ä»¶è®°å½• CRUD åŠŸèƒ½ - âœ… å·²å®Œæˆ
- [x] æ£€æŸ¥ä»·æ ¼é…ç½® CRUD åŠŸèƒ½ - âœ… å·²å®Œæˆ
- [x] æ£€æŸ¥è®¡ä»¶ç»Ÿè®¡åŠŸèƒ½ - âœ… å·²å®Œæˆ
- [ ] ä¿®å¤ createPieceWorkRecord å‡½æ•° - â³ å¾…ä¿®å¤
- [ ] ä¿®å¤ upsertCategoryPrice å‡½æ•° - â³ å¾…ä¿®å¤
- [ ] ä¿®å¤ batchUpsertCategoryPrices å‡½æ•° - â³ å¾…ä¿®å¤
- [ ] æµ‹è¯•éªŒè¯ - â³ å¾…æµ‹è¯•

---

**æ£€æŸ¥æ—¥æœŸ**ï¼š2025-11-26  
**æ£€æŸ¥äººå‘˜**ï¼šç§’å“’ AI  
**çŠ¶æ€**ï¼šâœ… æ£€æŸ¥å®Œæˆï¼Œå‘ç° 3 ä¸ªéœ€è¦ä¿®å¤çš„é—®é¢˜

## ğŸ¯ æ€»ç»“

### æ ¸å¿ƒå‘ç°
1. âœ… è®¡ä»¶ç®¡ç†çš„å¤§éƒ¨åˆ†åŠŸèƒ½å·²æ­£ç¡®é€‚é…å¤šç§Ÿæˆ·æ¶æ„
2. âœ… RLS ç­–ç•¥å·²æ­£ç¡®å®ç°ï¼Œç¡®ä¿æ•°æ®åº“å±‚é¢çš„ç§Ÿæˆ·éš”ç¦»
3. âŒ åˆ›å»ºè®¡ä»¶è®°å½•å‡½æ•°éœ€è¦ä¿®å¤ï¼Œç¼ºå°‘ `boss_id` å’Œ `tenant_id`ï¼ˆ**ä¸¥é‡é—®é¢˜**ï¼‰
4. âŒ åˆ›å»º/æ›´æ–°ä»·æ ¼é…ç½®å‡½æ•°éœ€è¦ä¿®å¤ï¼Œç¼ºå°‘ `boss_id` å’Œ `tenant_id`ï¼ˆ**ä¸¥é‡é—®é¢˜**ï¼‰
5. âŒ æ‰¹é‡åˆ›å»º/æ›´æ–°ä»·æ ¼é…ç½®å‡½æ•°éœ€è¦ä¿®å¤ï¼Œç¼ºå°‘ `boss_id` å’Œ `tenant_id`ï¼ˆ**ä¸¥é‡é—®é¢˜**ï¼‰

### æ¶æ„ä¿è¯
1. âœ… æ•°æ®åº“å±‚é¢ï¼šRLS ç­–ç•¥ç¡®ä¿ç§Ÿæˆ·éš”ç¦»
2. âœ… åº”ç”¨å±‚é¢ï¼šåˆ›å»ºå‡½æ•°è‡ªåŠ¨æ·»åŠ ç§Ÿæˆ·æ ‡è¯†å­—æ®µ
3. âœ… åŒé‡ä¿æŠ¤ï¼šå³ä½¿åº”ç”¨å±‚æœ‰æ¼æ´ï¼Œæ•°æ®åº“ä¹Ÿä¼šé˜»æ­¢è·¨ç§Ÿæˆ·è®¿é—®

### ä¿®å¤å»ºè®®
1. **ç«‹å³ä¿®å¤**ï¼š`createPieceWorkRecord` å‡½æ•°ï¼ˆ**é«˜ä¼˜å…ˆçº§ï¼Œä¸¥é‡é—®é¢˜**ï¼‰
2. **ç«‹å³ä¿®å¤**ï¼š`upsertCategoryPrice` å‡½æ•°ï¼ˆ**é«˜ä¼˜å…ˆçº§ï¼Œä¸¥é‡é—®é¢˜**ï¼‰
3. **ç«‹å³ä¿®å¤**ï¼š`batchUpsertCategoryPrices` å‡½æ•°ï¼ˆ**é«˜ä¼˜å…ˆçº§ï¼Œä¸¥é‡é—®é¢˜**ï¼‰
4. **æµ‹è¯•éªŒè¯**ï¼šä¿®å¤åè¿›è¡Œå…¨é¢æµ‹è¯•
5. **æ–‡æ¡£æ›´æ–°**ï¼šæ›´æ–°ç›¸å…³æ–‡æ¡£

### ä¿®å¤åçš„æ•ˆæœ
- âœ… æ‰€æœ‰è®¡ä»¶ç®¡ç†åŠŸèƒ½éƒ½æ­£ç¡®é€‚é…å¤šç§Ÿæˆ·æ¶æ„
- âœ… æ¯ä¸ªç§Ÿæˆ·çš„æ•°æ®å®Œå…¨éš”ç¦»
- âœ… æ— æ³•è·¨ç§Ÿæˆ·è®¿é—®æˆ–æ“ä½œæ•°æ®
- âœ… å¸æœºå¯ä»¥æ­£å¸¸åˆ›å»ºè®¡ä»¶è®°å½•
- âœ… ç®¡ç†å‘˜å¯ä»¥æ­£å¸¸åˆ›å»ºè®¡ä»¶è®°å½•
- âœ… è€æ¿å¯ä»¥æ­£å¸¸è®¾ç½®ä»·æ ¼é…ç½®
- âœ… ç®¡ç†å‘˜å¯ä»¥æ­£å¸¸è®¾ç½®ä»·æ ¼é…ç½®

### é—®é¢˜ä¸¥é‡æ€§åˆ†æ
- **ä¸¥é‡ç¨‹åº¦**ï¼šğŸ”´ é«˜
- **å½±å“èŒƒå›´**ï¼šè®¡ä»¶ç®¡ç†çš„æ ¸å¿ƒåŠŸèƒ½
- **å½±å“ç”¨æˆ·**ï¼šæ‰€æœ‰å¸æœºã€ç®¡ç†å‘˜å’Œè€æ¿
- **ä¿®å¤ä¼˜å…ˆçº§**ï¼šæœ€é«˜
- **ä¿®å¤éš¾åº¦**ï¼šä½ï¼ˆåªéœ€æ·»åŠ å‡ è¡Œä»£ç ï¼‰
