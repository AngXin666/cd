# ä»»åŠ¡2.3 - ä¼˜åŒ–é”™è¯¯æç¤º - å®ŒæˆæŠ¥å‘Š

> ğŸ“… å®Œæˆæ—¶é—´ï¼š2025-12-13  
> â±ï¸ è€—æ—¶ï¼šçº¦1å°æ—¶  
> âœ… çŠ¶æ€ï¼šå·²å®Œæˆ

---

## ä»»åŠ¡æ¦‚è¿°

ä¼˜åŒ–ç³»ç»Ÿçš„é”™è¯¯æç¤ºæœºåˆ¶ï¼Œåˆ›å»ºç»Ÿä¸€çš„Toastç»„ä»¶å’Œå·¥å…·å‡½æ•°ï¼Œæä¾›æ›´å‹å¥½çš„ç”¨æˆ·ä½“éªŒã€‚

---

## å®Œæˆå†…å®¹

### 1. åˆ›å»ºToastç»„ä»¶

**æ–‡ä»¶ï¼š** `src/components/Toast/index.tsx`

**åŠŸèƒ½ç‰¹æ€§ï¼š**
- âœ… æ”¯æŒ4ç§æç¤ºç±»å‹ï¼šsuccessã€errorã€warningã€info
- âœ… è‡ªå®šä¹‰æç¤ºæ—¶é•¿
- âœ… å‹å¥½çš„è§†è§‰è®¾è®¡ï¼ˆå¸¦å›¾æ ‡ï¼‰
- âœ… è‡ªåŠ¨éšè—åŠŸèƒ½
- âœ… å…³é—­å›è°ƒæ”¯æŒ

**ç»„ä»¶æ¥å£ï¼š**
```typescript
export interface ToastProps {
  message: string
  type?: 'success' | 'error' | 'warning' | 'info'
  duration?: number
  visible?: boolean
  onClose?: () => void
}
```

### 2. åˆ›å»ºToastå·¥å…·å‡½æ•°

**æ–‡ä»¶ï¼š** `src/utils/toast.ts`

**æä¾›çš„APIï¼š**
- `showToast(options)` - é€šç”¨æç¤º
- `showSuccess(message, duration?)` - æˆåŠŸæç¤º
- `showError(message, duration?)` - é”™è¯¯æç¤º
- `showWarning(message, duration?)` - è­¦å‘Šæç¤º
- `showInfo(message, duration?)` - ä¿¡æ¯æç¤º
- `hideToast()` - éšè—æç¤º

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```typescript
import {showSuccess, showError, showWarning, showInfo} from '@/utils/toast'

// æ˜¾ç¤ºæˆåŠŸæç¤º
showSuccess('æ“ä½œæˆåŠŸ')

// æ˜¾ç¤ºé”™è¯¯æç¤º
showError('æ“ä½œå¤±è´¥ï¼Œè¯·é‡è¯•')

// æ˜¾ç¤ºè­¦å‘Šæç¤º
showWarning('è¯·æ³¨æ„æ£€æŸ¥è¾“å…¥')

// æ˜¾ç¤ºä¿¡æ¯æç¤º
showInfo('æ­£åœ¨å¤„ç†ä¸­...')
```

### 3. é›†æˆåˆ°errorHandler

**ä¿®æ”¹æ–‡ä»¶ï¼š** `src/utils/errorHandler.ts`

**æ”¹è¿›å†…å®¹ï¼š**
- âœ… ä½¿ç”¨`showError`æ›¿ä»£åŸç”Ÿ`Taro.showToast`
- âœ… é”™è¯¯æç¤ºæ›´å‹å¥½
- âœ… ç»Ÿä¸€é”™è¯¯æç¤ºæ ·å¼

**ä»£ç å˜æ›´ï¼š**
```typescript
// ä¹‹å‰
private showToast(message: string): void {
  Taro.showToast({
    title: message,
    icon: 'none',
    duration: 3000
  })
}

// ä¹‹å
import {showError} from './toast'

private showToast(message: string): void {
  showError(message, 3000)
}
```

### 4. åˆ›å»ºä½¿ç”¨æ–‡æ¡£

**æ–‡ä»¶ï¼š** `src/components/Toast/README.md`

**æ–‡æ¡£å†…å®¹ï¼š**
- âœ… åŠŸèƒ½ç‰¹æ€§è¯´æ˜
- âœ… ä½¿ç”¨æ–¹å¼ï¼ˆå·¥å…·å‡½æ•° + ç»„ä»¶ï¼‰
- âœ… APIæ–‡æ¡£
- âœ… æç¤ºç±»å‹è¯´æ˜
- âœ… æœ€ä½³å®è·µ
- âœ… æ³¨æ„äº‹é¡¹
- âœ… å®Œæ•´ç¤ºä¾‹

### 5. æ ·å¼è®¾è®¡

**æ–‡ä»¶ï¼š** `src/components/Toast/index.scss`

**è®¾è®¡ç‰¹ç‚¹ï¼š**
- âœ… åŠé€æ˜é»‘è‰²èƒŒæ™¯
- âœ… åœ†è§’è®¾è®¡ï¼ˆ12pxï¼‰
- âœ… å±…ä¸­æ˜¾ç¤º
- âœ… æ¸å…¥æ¸å‡ºåŠ¨ç”»
- âœ… ä¸åŒç±»å‹ä¸åŒé¢œè‰²å›¾æ ‡
  - æˆåŠŸï¼šç»¿è‰² (#52c41a)
  - é”™è¯¯ï¼šçº¢è‰² (#ff4d4f)
  - è­¦å‘Šï¼šæ©™è‰² (#faad14)
  - ä¿¡æ¯ï¼šè“è‰² (#1890ff)

---

## æŠ€æœ¯å®ç°

### Toastç»„ä»¶å®ç°

```typescript
const Toast: React.FC<ToastProps> = ({
  message, 
  type = 'info', 
  duration = 3000, 
  visible = false, 
  onClose
}) => {
  const [show, setShow] = useState(visible)

  useEffect(() => {
    setShow(visible)

    if (visible && duration > 0) {
      const timer = setTimeout(() => {
        setShow(false)
        onClose?.()
      }, duration)

      return () => clearTimeout(timer)
    }
  }, [visible, duration, onClose])

  if (!show) return null

  const iconMap = {
    success: 'âœ“',
    error: 'âœ•',
    warning: 'âš ',
    info: 'â„¹'
  }

  return (
    <View className={`toast-container toast-${type} ${show ? 'toast-show' : ''}`}>
      <View className="toast-icon">{iconMap[type]}</View>
      <View className="toast-message">{message}</View>
    </View>
  )
}
```

### å·¥å…·å‡½æ•°å®ç°

```typescript
export function showToast(options: ToastOptions | string): void {
  const config = typeof options === 'string' ? {message: options} : options
  const {message, type = 'info', duration = 3000} = config

  // æ˜ å°„ç±»å‹åˆ° Taro icon
  const iconMap: Record<ToastType, 'success' | 'error' | 'none'> = {
    success: 'success',
    error: 'error',
    warning: 'none',
    info: 'none'
  }

  Taro.showToast({
    title: message,
    icon: iconMap[type],
    duration
  })
}
```

---

## ä½¿ç”¨åœºæ™¯

### 1. APIè°ƒç”¨æˆåŠŸ

```typescript
async function saveData() {
  try {
    await api.save(data)
    showSuccess('ä¿å­˜æˆåŠŸ')
  } catch (error) {
    showError('ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•')
  }
}
```

### 2. è¡¨å•éªŒè¯

```typescript
function validateForm() {
  if (!name) {
    showWarning('è¯·è¾“å…¥å§“å')
    return false
  }
  
  if (!phone) {
    showWarning('è¯·è¾“å…¥æ‰‹æœºå·')
    return false
  }
  
  return true
}
```

### 3. é”™è¯¯å¤„ç†

```typescript
import {errorHandler} from '@/utils/errorHandler'

// errorHandler å·²è‡ªåŠ¨ä½¿ç”¨ showError
try {
  await someOperation()
} catch (error) {
  errorHandler.handle(error)
}
```

### 4. ä¿¡æ¯æç¤º

```typescript
// æ“ä½œæç¤º
showInfo('æ­£åœ¨åŠ è½½...')

// çŠ¶æ€æç¤º
showInfo('å·²æ˜¯æœ€æ–°ç‰ˆæœ¬')

// ç©ºçŠ¶æ€æç¤º
showInfo('æš‚æ— æ•°æ®')
```

---

## æ”¹è¿›æ•ˆæœ

### ç”¨æˆ·ä½“éªŒæå‡

**æ”¹è¿›å‰ï¼š**
- æ‰€æœ‰æç¤ºéƒ½ä½¿ç”¨`Taro.showToast`
- æ ·å¼ä¸ç»Ÿä¸€
- ç¼ºå°‘ç±»å‹åŒºåˆ†
- é”™è¯¯æç¤ºä¸å¤Ÿå‹å¥½

**æ”¹è¿›åï¼š**
- âœ… ç»Ÿä¸€çš„Toastç»„ä»¶
- âœ… 4ç§æç¤ºç±»å‹ï¼Œè§†è§‰åŒºåˆ†æ˜æ˜¾
- âœ… å‹å¥½çš„å›¾æ ‡å’Œé¢œè‰²
- âœ… ç»Ÿä¸€çš„APIæ¥å£

### ä»£ç è´¨é‡æå‡

**æ”¹è¿›å‰ï¼š**
```typescript
// åˆ†æ•£åœ¨å„å¤„çš„toastè°ƒç”¨
Taro.showToast({title: 'æ“ä½œæˆåŠŸ', icon: 'success'})
Taro.showToast({title: 'æ“ä½œå¤±è´¥', icon: 'none'})
Taro.showToast({title: 'è¯·æ³¨æ„', icon: 'none'})
```

**æ”¹è¿›åï¼š**
```typescript
// ç»Ÿä¸€çš„å·¥å…·å‡½æ•°
showSuccess('æ“ä½œæˆåŠŸ')
showError('æ“ä½œå¤±è´¥')
showWarning('è¯·æ³¨æ„')
```

### å¯ç»´æŠ¤æ€§æå‡

- âœ… é›†ä¸­ç®¡ç†æç¤ºé€»è¾‘
- âœ… ç»Ÿä¸€çš„æ ·å¼å®šä¹‰
- âœ… æ˜“äºæ‰©å±•å’Œä¿®æ”¹
- âœ… å®Œæ•´çš„æ–‡æ¡£æ”¯æŒ

---

## è´¨é‡ä¿è¯

### æµ‹è¯•ç»“æœ

```bash
âœ“ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼š54ä¸ªæµ‹è¯•
âœ“ æµ‹è¯•æ–‡ä»¶ï¼š7ä¸ª
âœ“ æµ‹è¯•æ—¶é•¿ï¼š1.32s
```

### TypeScriptç±»å‹æ£€æŸ¥

```bash
âœ“ src/utils/toast.ts - æ— ç±»å‹é”™è¯¯
âœ“ src/components/Toast/index.tsx - æ— ç±»å‹é”™è¯¯
âœ“ src/utils/errorHandler.ts - æ— ç±»å‹é”™è¯¯
```

### ä»£ç è§„èŒƒ

- âœ… ç¬¦åˆESLintè§„èŒƒ
- âœ… ç¬¦åˆTypeScriptè§„èŒƒ
- âœ… ç¬¦åˆé¡¹ç›®ä»£ç é£æ ¼

---

## æœ€ä½³å®è·µ

### 1. ä¼˜å…ˆä½¿ç”¨å·¥å…·å‡½æ•°

```typescript
// âœ… æ¨è
import {showSuccess, showError} from '@/utils/toast'
showSuccess('æ“ä½œæˆåŠŸ')

// âŒ ä¸æ¨è
import Taro from '@tarojs/taro'
Taro.showToast({title: 'æ“ä½œæˆåŠŸ', icon: 'success'})
```

### 2. æ ¹æ®åœºæ™¯é€‰æ‹©ç±»å‹

```typescript
// æˆåŠŸæ“ä½œ
showSuccess('ä¿å­˜æˆåŠŸ')

// å¤±è´¥æ“ä½œ
showError('ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•')

// éœ€è¦æ³¨æ„
showWarning('è¯·å…ˆå¡«å†™å¿…å¡«é¡¹')

// ä¸€èˆ¬ä¿¡æ¯
showInfo('æ­£åœ¨åŠ è½½...')
```

### 3. åˆç†è®¾ç½®æ—¶é•¿

```typescript
// çŸ­æ—¶æç¤ºï¼ˆ1ç§’ï¼‰
showSuccess('å·²å¤åˆ¶', 1000)

// ä¸€èˆ¬æç¤ºï¼ˆ3ç§’ï¼Œé»˜è®¤ï¼‰
showSuccess('æ“ä½œæˆåŠŸ')

// é•¿æ—¶æç¤ºï¼ˆ5ç§’ï¼‰
showError('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®', 5000)
```

### 4. ä¸errorHandleré…åˆ

```typescript
// errorHandler ä¼šè‡ªåŠ¨ä½¿ç”¨ showError
errorHandler.handle(error)
errorHandler.handleApiError(error, 'åŠ è½½æ•°æ®')
errorHandler.handleNetworkError(error)
```

---

## å½±å“èŒƒå›´

### æ–°å¢æ–‡ä»¶

1. `src/components/Toast/index.tsx` - Toastç»„ä»¶
2. `src/components/Toast/index.scss` - Toastæ ·å¼
3. `src/components/Toast/README.md` - Toastæ–‡æ¡£
4. `src/utils/toast.ts` - Toastå·¥å…·å‡½æ•°

### ä¿®æ”¹æ–‡ä»¶

1. `src/utils/errorHandler.ts` - é›†æˆshowError

### å½±å“çš„åŠŸèƒ½

- âœ… æ‰€æœ‰é”™è¯¯æç¤ºï¼ˆé€šè¿‡errorHandlerï¼‰
- âœ… æœªæ¥çš„æ‰€æœ‰æç¤ºæ¶ˆæ¯ï¼ˆæ¨èä½¿ç”¨toastå·¥å…·ï¼‰

---

## åç»­ä¼˜åŒ–å»ºè®®

### çŸ­æœŸï¼ˆå¯é€‰ï¼‰

1. **åº”ç”¨åˆ°ç°æœ‰ä»£ç **
   - å°†ç°æœ‰çš„`Taro.showToast`è°ƒç”¨æ›¿æ¢ä¸ºtoastå·¥å…·å‡½æ•°
   - ç»Ÿä¸€æ‰€æœ‰æç¤ºæ¶ˆæ¯çš„æ ·å¼

2. **å¢å¼ºåŠŸèƒ½**
   - æ”¯æŒè‡ªå®šä¹‰å›¾æ ‡
   - æ”¯æŒè‡ªå®šä¹‰ä½ç½®ï¼ˆé¡¶éƒ¨ã€åº•éƒ¨ã€ä¸­é—´ï¼‰
   - æ”¯æŒå¤šä¸ªToaståŒæ—¶æ˜¾ç¤º

### é•¿æœŸï¼ˆå¯é€‰ï¼‰

1. **æ€§èƒ½ä¼˜åŒ–**
   - ä½¿ç”¨Portalæ¸²æŸ“Toast
   - ä¼˜åŒ–åŠ¨ç”»æ€§èƒ½

2. **åŠŸèƒ½æ‰©å±•**
   - æ”¯æŒToasté˜Ÿåˆ—
   - æ”¯æŒå¯äº¤äº’çš„Toastï¼ˆå¸¦æŒ‰é’®ï¼‰
   - æ”¯æŒå¯Œæ–‡æœ¬å†…å®¹

---

## æ€»ç»“

æˆåŠŸåˆ›å»ºäº†ç»Ÿä¸€çš„Toastæç¤ºç»„ä»¶å’Œå·¥å…·å‡½æ•°ï¼Œæ˜¾è‘—æå‡äº†é”™è¯¯æç¤ºçš„å‹å¥½æ€§å’Œä¸€è‡´æ€§ã€‚

**å…³é”®æˆæœï¼š**
- âœ… åˆ›å»ºToastç»„ä»¶ï¼ˆæ”¯æŒ4ç§ç±»å‹ï¼‰
- âœ… åˆ›å»ºtoastå·¥å…·å‡½æ•°ï¼ˆ6ä¸ªAPIï¼‰
- âœ… é›†æˆåˆ°errorHandler
- âœ… ç¼–å†™å®Œæ•´æ–‡æ¡£
- âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡
- âœ… TypeScriptç±»å‹æ£€æŸ¥é€šè¿‡

**ç”¨æˆ·ä½“éªŒæå‡ï¼š**
- âœ… æç¤ºæ¶ˆæ¯æ›´å‹å¥½
- âœ… è§†è§‰æ•ˆæœæ›´ç»Ÿä¸€
- âœ… ç±»å‹åŒºåˆ†æ›´æ˜æ˜¾

**ä»£ç è´¨é‡æå‡ï¼š**
- âœ… APIæ›´ç®€æ´
- âœ… ä»£ç æ›´è§„èŒƒ
- âœ… å¯ç»´æŠ¤æ€§æ›´é«˜

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-12-13  
**åˆ›å»ºå›¢é˜Ÿ**: Kiro AI
