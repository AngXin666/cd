# ç§Ÿèµç³»ç»Ÿæ•°æ®åº“æ¶æ„è®¾è®¡

## ğŸ“‹ æ¦‚è¿°

è½¦é˜Ÿç®¡å®¶ç³»ç»Ÿé‡‡ç”¨**ä¸¤å±‚æ•°æ®åº“æ¶æ„**ï¼Œå®ç°ç§Ÿèµç³»ç»Ÿå’Œç§Ÿæˆ·ä¸šåŠ¡æ•°æ®çš„æ¸…æ™°åˆ†ç¦»ã€‚

## ğŸ—ï¸ ä¸¤å±‚æ¶æ„è®¾è®¡

### ç¬¬ä¸€å±‚ï¼šç§Ÿèµç³»ç»Ÿå±‚ï¼ˆPublic Schemaï¼‰

**ç”¨é€”**ï¼šç®¡ç†ç§Ÿæˆ·è´¦å·ã€ç§ŸèµåˆåŒã€è´¦å•ç­‰"å…ƒæ•°æ®"

**å­˜å‚¨ä½ç½®**ï¼š`public` schema

**æ ¸å¿ƒè¡¨**ï¼š
- `profiles` - æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯ï¼ˆç§Ÿèµç®¡ç†å‘˜ã€ç§Ÿæˆ·è€æ¿ã€è½¦é˜Ÿé•¿ã€å¸æœºï¼‰
- `leases` - ç§ŸèµåˆåŒä¿¡æ¯
- `lease_bills` - è´¦å•ä¿¡æ¯

**è®¿é—®æƒé™**ï¼š
- ç§Ÿèµç®¡ç†å‘˜ï¼ˆ`lease_admin`ï¼‰ï¼šå¯ä»¥æŸ¥çœ‹ã€å¢åŠ ã€ä¿®æ”¹ã€åœç”¨ã€åˆ é™¤æ‰€æœ‰ç§Ÿæˆ·
- ç§Ÿæˆ·è€æ¿ï¼ˆ`super_admin`ï¼‰ï¼šåªèƒ½æŸ¥çœ‹è‡ªå·±çš„ä¿¡æ¯

### ç¬¬äºŒå±‚ï¼šç§Ÿæˆ·ä¸šåŠ¡å±‚ï¼ˆTenant Schemasï¼‰

**ç”¨é€”**ï¼šå­˜å‚¨æ¯ä¸ªç§Ÿæˆ·çš„ä¸šåŠ¡æ•°æ®ï¼ˆä»“åº“ã€å¸æœºã€è½¦è¾†ã€è€ƒå‹¤ç­‰ï¼‰

**å­˜å‚¨ä½ç½®**ï¼šç‹¬ç«‹çš„ `tenant_<uuid>` schema

**æ ¸å¿ƒè¡¨**ï¼š
- `warehouses` - ä»“åº“
- `vehicles` - è½¦è¾†
- `attendance` - è€ƒå‹¤è®°å½•
- `piece_work_records` - è®¡ä»¶è®°å½•
- ç­‰ç­‰...

**è®¿é—®æƒé™**ï¼š
- æ¯ä¸ªç§Ÿæˆ·åªèƒ½è®¿é—®è‡ªå·±çš„ Schema
- ç‰©ç†éš”ç¦»ï¼Œç»å¯¹å®‰å…¨

---

## ğŸ¯ ä¸ºä»€ä¹ˆç§Ÿèµç³»ç»Ÿä½¿ç”¨ Public Schemaï¼Ÿ

### 1. è·¨ç§Ÿæˆ·ç®¡ç†éœ€æ±‚

ç§Ÿèµç®¡ç†å‘˜éœ€è¦ï¼š
- âœ… æŸ¥çœ‹æ‰€æœ‰ç§Ÿæˆ·çš„åˆ—è¡¨
- âœ… åˆ›å»ºæ–°ç§Ÿæˆ·
- âœ… ä¿®æ”¹ç§Ÿæˆ·ä¿¡æ¯ï¼ˆå…¬å¸åã€è”ç³»æ–¹å¼ã€ç§ŸèµæœŸé™ç­‰ï¼‰
- âœ… åœç”¨/å¯ç”¨ç§Ÿæˆ·
- âœ… åˆ é™¤ç§Ÿæˆ·
- âœ… æŸ¥çœ‹æ‰€æœ‰ç§Ÿæˆ·çš„è´¦å•

å¦‚æœç§Ÿæˆ·ä¿¡æ¯åˆ†æ•£åœ¨å„è‡ªçš„ Schema ä¸­ï¼Œç§Ÿèµç®¡ç†å‘˜å°†æ— æ³•ç»Ÿä¸€ç®¡ç†ã€‚

### 2. å…ƒæ•°æ® vs ä¸šåŠ¡æ•°æ®

| æ•°æ®ç±»å‹ | å­˜å‚¨ä½ç½® | è®¿é—®è€… | ç¤ºä¾‹ |
|---------|---------|--------|------|
| **å…ƒæ•°æ®** | `public` schema | ç§Ÿèµç®¡ç†å‘˜ | ç§Ÿæˆ·è´¦å·ã€åˆåŒã€è´¦å• |
| **ä¸šåŠ¡æ•°æ®** | `tenant_xxx` schema | ç§Ÿæˆ·è‡ªå·± | ä»“åº“ã€å¸æœºã€è½¦è¾†ã€è€ƒå‹¤ |

è¿™ç§åˆ†å±‚è®¾è®¡ç¬¦åˆå¤šç§Ÿæˆ· SaaS ç³»ç»Ÿçš„æœ€ä½³å®è·µã€‚

### 3. æ¸…æ™°çš„èŒè´£åˆ†ç¦»

```
ç§Ÿèµç®¡ç†å‘˜ï¼ˆlease_adminï¼‰
  â†“
ç®¡ç†ç§Ÿæˆ·è´¦å·ï¼ˆpublic.profilesï¼‰
  â†“
ç§Ÿæˆ·è€æ¿ï¼ˆsuper_adminï¼‰
  â†“
ç®¡ç†è‡ªå·±çš„ä¸šåŠ¡æ•°æ®ï¼ˆtenant_xxx schemaï¼‰
  â†“
è½¦é˜Ÿé•¿ã€å¸æœº
```

---

## ğŸ“Š æ•°æ®åº“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Public Schema                             â”‚
â”‚  (ç§Ÿèµç³»ç»Ÿå±‚ - ç®¡ç†æ‰€æœ‰ç§Ÿæˆ·çš„å…ƒæ•°æ®)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  profiles    â”‚  â”‚   leases     â”‚  â”‚ lease_bills  â”‚      â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚      â”‚
â”‚  â”‚ - lease_adminâ”‚  â”‚ - ç§ŸèµåˆåŒ   â”‚  â”‚ - è´¦å•è®°å½•   â”‚      â”‚
â”‚  â”‚ - super_adminâ”‚  â”‚ - å¼€å§‹æ—¥æœŸ   â”‚  â”‚ - åº”ä»˜é‡‘é¢   â”‚      â”‚
â”‚  â”‚ - manager    â”‚  â”‚ - ç»“æŸæ—¥æœŸ   â”‚  â”‚ - æ”¯ä»˜çŠ¶æ€   â”‚      â”‚
â”‚  â”‚ - driver     â”‚  â”‚ - æœˆç§Ÿé‡‘     â”‚  â”‚              â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ ç§Ÿæˆ·è€æ¿ç™»å½•å
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Tenant Schema (tenant_xxx)                      â”‚
â”‚  (ç§Ÿæˆ·ä¸šåŠ¡å±‚ - æ¯ä¸ªç§Ÿæˆ·ç‹¬ç«‹çš„ä¸šåŠ¡æ•°æ®)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ warehouses   â”‚  â”‚  vehicles    â”‚  â”‚ attendance   â”‚      â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚      â”‚
â”‚  â”‚ - ä»“åº“åˆ—è¡¨   â”‚  â”‚ - è½¦è¾†åˆ—è¡¨   â”‚  â”‚ - è€ƒå‹¤è®°å½•   â”‚      â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚piece_work_   â”‚  â”‚leave_        â”‚  â”‚resignation_  â”‚      â”‚
â”‚  â”‚records       â”‚  â”‚applications  â”‚  â”‚applications  â”‚      â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚      â”‚
â”‚  â”‚ - è®¡ä»¶è®°å½•   â”‚  â”‚ - è¯·å‡ç”³è¯·   â”‚  â”‚ - ç¦»èŒç”³è¯·   â”‚      â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” æƒé™è®¾è®¡

### ç§Ÿèµç®¡ç†å‘˜ï¼ˆlease_adminï¼‰

**å¯ä»¥è®¿é—®**ï¼š
- âœ… `public.profiles` - æŸ¥çœ‹ã€å¢åŠ ã€ä¿®æ”¹ã€åœç”¨ã€åˆ é™¤æ‰€æœ‰ç§Ÿæˆ·
- âœ… `public.leases` - ç®¡ç†æ‰€æœ‰ç§ŸèµåˆåŒ
- âœ… `public.lease_bills` - ç®¡ç†æ‰€æœ‰è´¦å•

**ä¸èƒ½è®¿é—®**ï¼š
- âŒ ä»»ä½• `tenant_xxx` schema - ä¸èƒ½æŸ¥çœ‹ç§Ÿæˆ·çš„ä¸šåŠ¡æ•°æ®

**åŸå› **ï¼šç§Ÿèµç®¡ç†å‘˜åªè´Ÿè´£ç®¡ç†ç§Ÿæˆ·è´¦å·å’ŒåˆåŒï¼Œä¸åº”è¯¥è®¿é—®ç§Ÿæˆ·çš„ä¸šåŠ¡æ•°æ®ï¼ˆä¿æŠ¤ç§Ÿæˆ·éšç§ï¼‰ã€‚

### ç§Ÿæˆ·è€æ¿ï¼ˆsuper_adminï¼‰

**å¯ä»¥è®¿é—®**ï¼š
- âœ… `public.profiles` - åªèƒ½æŸ¥çœ‹è‡ªå·±çš„ä¿¡æ¯
- âœ… `tenant_xxx` schema - å®Œå…¨è®¿é—®è‡ªå·±çš„ä¸šåŠ¡æ•°æ®

**ä¸èƒ½è®¿é—®**ï¼š
- âŒ å…¶ä»–ç§Ÿæˆ·çš„ `tenant_yyy` schema
- âŒ å…¶ä»–ç§Ÿæˆ·çš„ `public.profiles` è®°å½•

---

## ğŸ’¡ ç§Ÿèµç³»ç»Ÿç®¡ç†ç§Ÿæˆ·çš„å®ç°

### 1. æŸ¥çœ‹æ‰€æœ‰ç§Ÿæˆ·

```typescript
import { supabase } from '@/client/supabase'

// ç§Ÿèµç®¡ç†å‘˜æŸ¥çœ‹æ‰€æœ‰ç§Ÿæˆ·
const { data: tenants } = await supabase
  .from('profiles')
  .select('*')
  .eq('role', 'super_admin')  // åªæŸ¥è¯¢ç§Ÿæˆ·è€æ¿
  .order('created_at', { ascending: false })
```

### 2. åˆ›å»ºæ–°ç§Ÿæˆ·

```typescript
import { createTenant } from '@/db/api'

// åˆ›å»ºæ–°ç§Ÿæˆ·ï¼ˆä¼šè‡ªåŠ¨åˆ›å»ºç‹¬ç«‹çš„ tenant_xxx schemaï¼‰
const newTenant = await createTenant(
  {
    name: 'å¼ ä¸‰',
    phone: '13900000001',
    company_name: 'å¼ ä¸‰ç‰©æµå…¬å¸',
    lease_start_date: '2025-01-01',
    lease_end_date: '2025-12-31',
    monthly_fee: 1000,
    // ...
  },
  null,
  '123456'  // å¯†ç 
)
```

**è‡ªåŠ¨åŒ–æµç¨‹**ï¼š
1. åœ¨ `public.profiles` åˆ›å»ºç§Ÿæˆ·è®°å½•ï¼ˆrole = super_adminï¼‰
2. è§¦å‘å™¨è‡ªåŠ¨åˆ›å»º `tenant_xxx` schema
3. åœ¨ schema ä¸­åˆ›å»ºæ‰€æœ‰ä¸šåŠ¡è¡¨
4. åˆ›å»ºé»˜è®¤ä»“åº“

### 3. ä¿®æ”¹ç§Ÿæˆ·ä¿¡æ¯

```typescript
import { updateTenant } from '@/db/api'

// ä¿®æ”¹ç§Ÿæˆ·ä¿¡æ¯ï¼ˆåªä¿®æ”¹ public.profiles ä¸­çš„è®°å½•ï¼‰
await updateTenant(tenantId, {
  name: 'å¼ ä¸‰',
  company_name: 'å¼ ä¸‰ç‰©æµå…¬å¸ï¼ˆæ–°ï¼‰',
  lease_end_date: '2026-12-31',
  monthly_fee: 1200,
  // ...
})
```

### 4. åœç”¨ç§Ÿæˆ·

```typescript
import { supabase } from '@/client/supabase'

// åœç”¨ç§Ÿæˆ·ï¼ˆè®¾ç½® status = 'inactive'ï¼‰
await supabase
  .from('profiles')
  .update({ status: 'inactive' })
  .eq('id', tenantId)
```

**æ•ˆæœ**ï¼š
- ç§Ÿæˆ·æ— æ³•ç™»å½•
- ç§Ÿæˆ·çš„ä¸šåŠ¡æ•°æ®ä»ç„¶ä¿ç•™åœ¨ `tenant_xxx` schema ä¸­
- å¯ä»¥éšæ—¶é‡æ–°å¯ç”¨

### 5. åˆ é™¤ç§Ÿæˆ·

```typescript
import { supabase } from '@/client/supabase'

// åˆ é™¤ç§Ÿæˆ·ï¼ˆéœ€è¦å…ˆåˆ é™¤ tenant_xxx schemaï¼‰
// æ­¥éª¤1ï¼šåˆ é™¤ç§Ÿæˆ·çš„ schema
await supabase.rpc('drop_tenant_schema', { tenant_boss_id: tenantId })

// æ­¥éª¤2ï¼šåˆ é™¤ public.profiles ä¸­çš„è®°å½•
await supabase
  .from('profiles')
  .delete()
  .eq('id', tenantId)
```

**æ³¨æ„**ï¼šåˆ é™¤æ“ä½œä¸å¯é€†ï¼Œå»ºè®®å…ˆåœç”¨è€Œä¸æ˜¯åˆ é™¤ã€‚

---

## ğŸ› ï¸ æ•°æ®åº“å‡½æ•°

### åˆ é™¤ç§Ÿæˆ· Schema

```sql
CREATE OR REPLACE FUNCTION drop_tenant_schema(tenant_boss_id text)
RETURNS void
LANGUAGE plpgsql
SECURITY DEFINER
AS $$
DECLARE
  schema_name text;
BEGIN
  -- æ„é€  Schema åç§°
  schema_name := 'tenant_' || replace(tenant_boss_id, '-', '_');
  
  -- æ£€æŸ¥ Schema æ˜¯å¦å­˜åœ¨
  IF EXISTS (
    SELECT 1 FROM information_schema.schemata
    WHERE schema_name = schema_name
  ) THEN
    -- åˆ é™¤ Schemaï¼ˆCASCADE ä¼šåˆ é™¤æ‰€æœ‰è¡¨ï¼‰
    EXECUTE format('DROP SCHEMA %I CASCADE', schema_name);
    RAISE NOTICE 'âœ… ç§Ÿæˆ· Schema å·²åˆ é™¤: %', schema_name;
  ELSE
    RAISE NOTICE 'âš ï¸ ç§Ÿæˆ· Schema ä¸å­˜åœ¨: %', schema_name;
  END IF;
END;
$$;
```

---

## ğŸ“ æœ€ä½³å®è·µ

### 1. ç§Ÿæˆ·ä¿¡æ¯å§‹ç»ˆåœ¨ Public Schema

- âœ… æ‰€æœ‰ç§Ÿæˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼ˆå§“åã€æ‰‹æœºå·ã€å…¬å¸åã€ç§ŸèµæœŸé™ç­‰ï¼‰å­˜å‚¨åœ¨ `public.profiles`
- âœ… ç§Ÿèµç®¡ç†å‘˜é€šè¿‡æŸ¥è¯¢ `public.profiles` ç®¡ç†ç§Ÿæˆ·
- âŒ ä¸è¦åœ¨ `tenant_xxx` schema ä¸­å­˜å‚¨ç§Ÿæˆ·çš„åŸºæœ¬ä¿¡æ¯

### 2. ä¸šåŠ¡æ•°æ®å§‹ç»ˆåœ¨ Tenant Schema

- âœ… ç§Ÿæˆ·çš„ä¸šåŠ¡æ•°æ®ï¼ˆä»“åº“ã€å¸æœºã€è½¦è¾†ç­‰ï¼‰å­˜å‚¨åœ¨ `tenant_xxx` schema
- âœ… ç§Ÿæˆ·è€æ¿é€šè¿‡ `getTenantSupabaseClient()` è®¿é—®è‡ªå·±çš„ä¸šåŠ¡æ•°æ®
- âŒ ä¸è¦åœ¨ `public` schema ä¸­å­˜å‚¨ç§Ÿæˆ·çš„ä¸šåŠ¡æ•°æ®

### 3. åœç”¨ä¼˜äºåˆ é™¤

- âœ… åœç”¨ç§Ÿæˆ·ï¼šè®¾ç½® `status = 'inactive'`ï¼Œæ•°æ®ä¿ç•™
- âš ï¸ åˆ é™¤ç§Ÿæˆ·ï¼šåˆ é™¤ schema å’Œæ‰€æœ‰æ•°æ®ï¼Œä¸å¯æ¢å¤
- ğŸ’¡ å»ºè®®ï¼šå…ˆåœç”¨ï¼Œç¡®è®¤ä¸éœ€è¦åå†åˆ é™¤

### 4. ç§Ÿèµç®¡ç†å‘˜ä¸è®¿é—®ç§Ÿæˆ·ä¸šåŠ¡æ•°æ®

- âœ… ç§Ÿèµç®¡ç†å‘˜åªç®¡ç†ç§Ÿæˆ·è´¦å·å’ŒåˆåŒ
- âŒ ç§Ÿèµç®¡ç†å‘˜ä¸åº”è¯¥è®¿é—®ç§Ÿæˆ·çš„ä¸šåŠ¡æ•°æ®ï¼ˆä¿æŠ¤éšç§ï¼‰
- ğŸ’¡ å¦‚æœéœ€è¦æŸ¥çœ‹ç§Ÿæˆ·æ•°æ®ï¼Œåº”è¯¥ç”±ç§Ÿæˆ·æˆæƒ

---

## ğŸ‰ æ€»ç»“

### ä¸¤å±‚æ¶æ„çš„ä¼˜åŠ¿

| ä¼˜åŠ¿ | è¯´æ˜ |
|------|------|
| **æ¸…æ™°çš„èŒè´£åˆ†ç¦»** | ç§Ÿèµç³»ç»Ÿç®¡ç†ç§Ÿæˆ·ï¼Œç§Ÿæˆ·ç®¡ç†ä¸šåŠ¡ |
| **æ•°æ®éš”ç¦»** | ç§Ÿæˆ·ä¸šåŠ¡æ•°æ®ç‰©ç†éš”ç¦»ï¼Œç»å¯¹å®‰å…¨ |
| **ç»Ÿä¸€ç®¡ç†** | ç§Ÿèµç®¡ç†å‘˜å¯ä»¥ç»Ÿä¸€ç®¡ç†æ‰€æœ‰ç§Ÿæˆ· |
| **çµæ´»æ‰©å±•** | æ–°å¢ç§Ÿæˆ·è‡ªåŠ¨åˆ›å»ºç‹¬ç«‹ Schema |
| **æ˜“äºç»´æŠ¤** | æ¶æ„æ¸…æ™°ï¼Œé—®é¢˜æ˜“å®šä½ |

### æ ¸å¿ƒåŸåˆ™

1. **ç§Ÿèµç³»ç»Ÿæ•°æ®** â†’ `public` schema
2. **ç§Ÿæˆ·ä¸šåŠ¡æ•°æ®** â†’ `tenant_xxx` schema
3. **ç§Ÿèµç®¡ç†å‘˜** â†’ ç®¡ç† `public.profiles`
4. **ç§Ÿæˆ·è€æ¿** â†’ ç®¡ç† `tenant_xxx` schema

è¿™æ˜¯ä¸€ä¸ª**æ¸…æ™°ã€å®‰å…¨ã€æ˜“ç»´æŠ¤**çš„å¤šç§Ÿæˆ· SaaS ç³»ç»Ÿæ¶æ„ï¼ğŸŠ

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ç‹¬ç«‹æ•°æ®åº“éš”ç¦»æ¶æ„](../SCHEMA_ISOLATION_SUMMARY.md)
- [å¿«é€Ÿå…¥é—¨æŒ‡å—](../QUICK_START_SCHEMA_ISOLATION.md)
- [è‡ªåŠ¨åˆ›å»ºæµ‹è¯•æŒ‡å—](AUTO_CREATE_TENANT_SCHEMA_TEST.md)
- [å®æ–½æŠ¥å‘Š](../SCHEMA_ISOLATION_IMPLEMENTATION_REPORT.md)
