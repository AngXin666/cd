# 搜索功能优化说明

## 功能概述

为双管理员端（普通管理员和超级管理员）的司机管理和用户管理页面优化了搜索功能，将搜索框改为可展开/收起的形式，节省屏幕空间，提升用户体验。

## 优化内容

### 1. 普通管理员端 - 司机管理页面

**文件路径**: `src/pages/manager/driver-management/index.tsx`

**优化前**:
- 搜索框始终显示在页面上
- 占用固定的屏幕空间
- 即使不需要搜索时也会显示

**优化后**:
- ✅ 添加搜索按钮，点击后展开/收起搜索框
- ✅ 搜索框默认隐藏，节省屏幕空间
- ✅ 展开时显示完整的搜索框
- ✅ 收起时自动清空搜索关键词
- ✅ 按钮文字和图标根据状态动态变化

**实现细节**:
1. **状态管理**:
   - `showSearch`: 控制搜索框的显示/隐藏状态（默认为 false）

2. **切换函数**:
   ```typescript
   const toggleSearch = () => {
     setShowSearch(!showSearch)
     if (showSearch) {
       // 收起时清空搜索关键词
       setSearchKeyword('')
     }
   }
   ```

3. **UI设计**:
   - 搜索按钮位于仓库切换器之后
   - 按钮样式：白色背景、蓝色文字、圆角边框、阴影效果
   - 展开状态：显示"收起搜索"和关闭图标
   - 收起状态：显示"展开搜索"和搜索图标
   - 点击时有缩放动画效果（active:scale-98）

### 2. 超级管理员端 - 用户管理页面

**文件路径**: `src/pages/super-admin/user-management/index.tsx`

**优化前**:
- 搜索框始终显示在页面上
- 占用固定的屏幕空间
- 即使不需要搜索时也会显示

**优化后**:
- ✅ 添加搜索按钮，点击后展开/收起搜索框
- ✅ 搜索框默认隐藏，节省屏幕空间
- ✅ 展开时显示完整的搜索框
- ✅ 收起时自动清空搜索关键词
- ✅ 按钮文字根据当前标签页动态变化（"搜索司机"或"搜索管理员"）

**实现细节**:
1. **状态管理**:
   - `showSearch`: 控制搜索框的显示/隐藏状态（默认为 false）

2. **切换函数**:
   ```typescript
   const toggleSearch = () => {
     setShowSearch(!showSearch)
     if (showSearch) {
       // 收起时清空搜索关键词
       setSearchKeyword('')
     }
   }
   ```

3. **UI设计**:
   - 搜索按钮位于标签页切换器之后
   - 按钮样式：白色背景、蓝色文字、圆角边框、阴影效果
   - 展开状态：显示"收起搜索"和关闭图标
   - 收起状态：根据当前标签页显示"搜索司机"或"搜索管理员"和搜索图标
   - 点击时有缩放动画效果（active:scale-98）

## UI设计特点

### 搜索按钮样式
- **背景**: 白色（bg-white）
- **边框**: 灰色边框（border border-gray-200）
- **阴影**: 轻微阴影（shadow-sm）
- **圆角**: 大圆角（rounded-lg）
- **内边距**: py-3 px-4
- **文字颜色**: 蓝色（text-blue-600）
- **图标**: 搜索图标（i-mdi-magnify）或关闭图标（i-mdi-close）
- **动画**: 点击时缩放效果（active:scale-98 transition-all）

### 搜索框样式
- **背景**: 白色卡片（bg-white）
- **圆角**: 大圆角（rounded-lg）
- **阴影**: 轻微阴影（shadow-sm）
- **内边距**: p-4
- **输入框**: 灰色背景（bg-gray-50）、灰色边框（border-gray-300）

### 按钮文字变化
- **普通管理员端**:
  - 收起状态：展开搜索
  - 展开状态：收起搜索

- **超级管理员端**:
  - 收起状态（司机标签页）：搜索司机
  - 收起状态（管理员标签页）：搜索管理员
  - 展开状态：收起搜索

## 用户体验优化

1. **节省空间**: 默认隐藏搜索框，让页面更简洁，用户可以看到更多内容
2. **按需展开**: 用户需要搜索时再展开，避免不必要的干扰
3. **自动清空**: 收起搜索框时自动清空搜索关键词，避免遗留的过滤状态
4. **视觉反馈**: 按钮文字和图标根据状态动态变化，清晰表达当前状态
5. **动画效果**: 点击时有缩放动画，提升交互体验

## 技术实现要点

### 1. 状态管理
```typescript
// 搜索框展开状态
const [showSearch, setShowSearch] = useState(false)
```

### 2. 切换函数
```typescript
const toggleSearch = () => {
  setShowSearch(!showSearch)
  if (showSearch) {
    // 收起时清空搜索关键词
    setSearchKeyword('')
  }
}
```

### 3. 条件渲染
```typescript
{/* 搜索按钮 */}
<View onClick={toggleSearch}>
  <View className={`${showSearch ? 'i-mdi-close' : 'i-mdi-magnify'}`} />
  <Text>{showSearch ? '收起搜索' : '展开搜索'}</Text>
</View>

{/* 搜索框（可展开/收起） */}
{showSearch && (
  <View>
    <Input ... />
  </View>
)}
```

## 测试验证

### 功能测试
- ✅ 点击搜索按钮可以展开搜索框
- ✅ 点击搜索按钮可以收起搜索框
- ✅ 收起搜索框时自动清空搜索关键词
- ✅ 展开搜索框后可以正常输入和搜索
- ✅ 搜索功能与仓库过滤兼容

### UI测试
- ✅ 按钮文字和图标根据状态正确变化
- ✅ 点击按钮时有缩放动画效果
- ✅ 搜索框展开/收起动画流畅
- ✅ 按钮样式符合设计规范

### 边界测试
- ✅ 在不同标签页切换时搜索框状态正常
- ✅ 在有搜索关键词时收起搜索框，关键词被清空
- ✅ 在有搜索结果时收起搜索框，列表恢复显示所有数据

## 修改的文件

1. **src/pages/manager/driver-management/index.tsx**
   - 添加 `showSearch` 状态变量
   - 添加 `toggleSearch` 切换函数
   - 修改搜索框UI，改为可展开/收起

2. **src/pages/super-admin/user-management/index.tsx**
   - 添加 `showSearch` 状态变量
   - 添加 `toggleSearch` 切换函数
   - 修改搜索框UI，改为可展开/收起

3. **docs/搜索功能优化说明.md**
   - 创建详细的功能优化说明文档

## 使用说明

### 普通管理员端
1. 进入"司机管理"页面
2. 点击"展开搜索"按钮
3. 输入搜索关键词（司机姓名或手机号）
4. 查看搜索结果
5. 点击"收起搜索"按钮，搜索框隐藏，搜索关键词被清空

### 超级管理员端
1. 进入"用户管理"页面
2. 切换到"司机管理"或"管理员管理"标签页
3. 点击"搜索司机"或"搜索管理员"按钮
4. 输入搜索关键词（姓名、手机号或邮箱）
5. 查看搜索结果
6. 点击"收起搜索"按钮，搜索框隐藏，搜索关键词被清空

## 后续优化建议

1. **记忆功能**: 记住用户的搜索框展开状态，下次进入时保持
2. **快捷键**: 添加快捷键支持，如按"/"键快速展开搜索框
3. **搜索历史**: 记录最近的搜索关键词，方便快速搜索
4. **高级搜索**: 添加更多搜索条件，如按角色、状态等筛选

## 相关文件

- `src/pages/manager/driver-management/index.tsx` - 普通管理员司机管理页面
- `src/pages/super-admin/user-management/index.tsx` - 超级管理员用户管理页面

## 更新日期

2025-11-05
