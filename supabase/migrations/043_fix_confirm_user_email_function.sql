/*
# 修复自动确认用户邮箱的函数

## 问题
confirmed_at 是一个生成列（GENERATED ALWAYS），不能直接更新。
\#U4ed3#U5e93#U663e#U793a#U4f18#U5316#U603b#U7ed3.md \#U4f18#U5316#U5b8c#U6210_#U7ba1#U7406#U7aef#U8bf7#U5047#U5ba1#U6279#U548c#U6253#U5361#U8bb0#U5f55.md \#U4f18#U5316#U8f66#U8f86#U7ba1#U7406#U5f55#U5165#U4f53#U9a8c.md \#U4fdd#U5b58#U5931#U8d25#U9519#U8bef#U6392#U67e5#U6307#U5357.md \#U4fee#U590d#U56fe#U7247#U663e#U793a#U95ee#U9898.md \#U4fee#U590d#U5b8c#U6210_#U4ed3#U5e93#U7ba1#U7406#U529f#U80fd.md \#U4fee#U590dwarehouse_id#U7ea6#U675f#U9519#U8bef.md \#U529f#U80fd#U4f18#U5316#U603b#U7ed3#U62a5#U544a.md \#U53f8#U673a#U7aef#U54c1#U7c7b#U81ea#U52a8#U9501#U5b9a#U529f#U80fd#U6d4b#U8bd5#U6307#U5357.md \#U53f8#U673a#U7aef#U8003#U52e4#U6253#U5361#U95ee#U9898#U4fee#U590d#U603b#U7ed3.md \#U53f8#U673a#U7c7b#U578b#U663e#U793a#U95ee#U9898#U6392#U67e5#U6307#U5357.md \#U53f8#U673a#U7c7b#U578b#U7cfb#U7edf#U91cd#U6784#U8bf4#U660e.md \#U53f8#U673a#U7c7b#U578b#U7f16#U8f91#U4fee#U590d#U9a8c#U8bc1#U6307#U5357.md \#U53f8#U673a#U7c7b#U578b#U7f16#U8f91#U95ee#U9898#U4fee#U590d#U603b#U7ed3.md \#U53f8#U673a#U7c7b#U578b#U8c03#U8bd5#U6307#U5357.md \#U53f8#U673a#U7edf#U8ba1#U529f#U80fd#U5b9e#U73b0#U603b#U7ed3.md \#U53f8#U673a#U7edf#U8ba1#U6807#U7b7e#U9875#U6253#U5361#U6570#U636e#U4e0d#U663e#U793a#U95ee#U9898#U4fee#U590d#U8bf4#U660e.md \#U540c#U6b65#U4ee3#U7801#U4fee#U590d#U603b#U7ed3.md \#U540c#U6b65#U4ee3#U7801#U5ba1#U67e5#U62a5#U544a.md \#U56fe#U7247#U4e0a#U4f20#U517c#U5bb9#U6027#U95ee#U9898#U4fee#U590d#U603b#U7ed3.md \#U56fe#U7247#U81ea#U52a8#U6a2a#U5411#U65cb#U8f6c#U529f#U80fd#U8bf4#U660e.md \#U5feb#U901f#U8c03#U8bd5#U6307#U5357.md \#U6253#U5361#U8bb0#U5f55#U7b5b#U9009#U6761#U4ef6#U4f18#U5316#U8bf4#U660e.md \#U6253#U5361#U8bb0#U5f55#U96c6#U6210#U5230#U5ba1#U6279#U9875#U9762.md \#U667a#U80fd#U7f13#U5b58#U529f#U80fd#U8bf4#U660e.md \#U6743#U9650#U5206#U914d#U4fee#U590d#U8bf4#U660e.md \#U6d4b#U8bd5#U6307#U5357_#U4ed3#U5e93#U7981#U7528#U542f#U7528#U529f#U80fd.md \#U6d4b#U8bd5#U9a8c#U8bc1#U8bf4#U660e.md \#U6dfb#U52a0#U9a7e#U9a76#U5458#U4fe1#U606f#U5c55#U793a.md \#U7528#U6237#U8be6#U60c5#U9875#U9762#U529f#U80fd#U8bf4#U660e.md \#U7528#U6237#U8be6#U60c5#U9875#U9762#U529f#U80fd#U9a8c#U8bc1.md \#U7528#U6237#U8be6#U60c5#U9875#U9762#U589e#U5f3a#U8bf4#U660e.md \#U7b5b#U9009#U533a#U57dfUI#U4f18#U5316#U8bf4#U660e.md \#U8003#U52e4#U7ba1#U7406#U529f#U80fd#U4f18#U5316#U5b8c#U6210#U62a5#U544a.md \#U8003#U52e4#U7ba1#U7406#U9875#U9762#U6574#U5408#U8bf4#U660e.md \#U8003#U52e4#U89c4#U5219#U67e5#U8be2#U9519#U8bef#U4fee#U590d#U8bf4#U660e.md \#U884c#U9a76#U8bc1#U526f#U9875#U80cc#U9875#U68c0#U9a8c#U6709#U6548#U671f#U8bc6#U522b#U4f18#U5316.md \#U884c#U9a76#U8bc1#U62cd#U7167#U95ee#U9898#U8c03#U8bd5#U6307#U5357.md \#U884c#U9a76#U8bc1#U8bc6#U522b#U529f#U80fd#U4fee#U590d#U8bf4#U660e.md \#U884c#U9a76#U8bc1#U8bc6#U522b#U529f#U80fd#U5b8c#U6574#U4fee#U590d#U603b#U7ed3.md \#U89d2#U8272#U7ba1#U7406#U529f#U80fd#U8bf4#U660e.md \#U8d85#U7ea7#U7ba1#U7406#U5458#U8003#U52e4#U7ba1#U7406#U6570#U636e#U52a0#U8f7d#U95ee#U9898#U4fee#U590d#U8bf4#U660e.md \#U8d85#U7ea7#U7ba1#U7406#U7aef#U8003#U52e4#U7ba1#U7406#U4f18#U5316.md \#U8d85#U7ea7#U7ba1#U7406#U7aef#U8f66#U8f86#U7ba1#U7406#U529f#U80fd#U8bf4#U660e.md \#U8f66#U8f86#U5217#U8868#U7ade#U6001#U6761#U4ef6#U4fee#U590d#U8bf4#U660e.md \#U8f66#U8f86#U6dfb#U52a0#U529f#U80fd#U9519#U8bef#U4fee#U590d.md \#U8f66#U8f86#U7167#U7247#U529f#U80fd#U4fee#U590d#U8bf4#U660e.md \#U8f66#U8f86#U7ba1#U7406#U529f#U80fd#U5b9e#U73b0#U65b9#U6848.md \#U8f66#U8f86#U7ba1#U7406#U529f#U80fd#U8bf4#U660e.md \#U8f66#U8f86#U7ba1#U7406UI#U4f18#U5316#U8bf4#U660e.md \#U8fbe#U6807#U7387#U4fee#U590d#U603b#U7ed3.md \#U8fbe#U6807#U7387#U7b97#U6cd5#U68c0#U67e5#U62a5#U544a.md \#U95ee#U9898#U4fee#U590d#U603b#U7ed3.md .editorconfig .env .env.development .env.production .env.test .git .gitignore .swc .sync ACCOUNT_FIX_SUMMARY.md ACCOUNT_RESET_SUMMARY.md ADD_DRIVER_FEATURE.md ADMIN2_ACCOUNT_CREATED.md ADMIN_ACCOUNTS.md ALL_ACCOUNTS.md ALL_FIXES_SUMMARY.md APPLICATION_DETAIL_FEATURE.md ATTENDANCE_CACHE_OPTIMIZATION.md ATTENDANCE_CHECK_FEATURE.md ATTENDANCE_DISPLAY_FIX.md ATTENDANCE_ENHANCEMENT.md ATTENDANCE_FINAL_SUMMARY.md ATTENDANCE_FINAL_UPDATE.md ATTENDANCE_FIXES_SUMMARY.md ATTENDANCE_FIX_SUMMARY.md ATTENDANCE_OPTIMIZATION.md ATTENDANCE_RATE_FEATURE.md ATTENDANCE_RATE_FINAL_UPDATE.md ATTENDANCE_RATE_QUICK_REF.md ATTENDANCE_RATE_SUMMARY.md ATTENDANCE_RATE_TEST.md ATTENDANCE_RATE_VERIFICATION.md ATTENDANCE_SHOW_ALL_DRIVERS_FIX.md ATTENDANCE_SIMPLIFICATION.md ATTENDANCE_STATUS_LABELS.md ATTENDANCE_UPDATE_SUMMARY.md AUTH_FIX_REPORT.md BADGE_POSITION_FIX.md BUGFIX_#U4ed3#U5e93#U7981#U7528#U540e#U65e0#U6cd5#U91cd#U65b0#U542f#U7528.md BUGFIX_#U53f8#U673a#U6253#U5361#U95ee#U9898.md BUGFIX_PROFILE_IMAGE_LOADING.md BUTTON_DISPLAY_FIX.md CACHE_AND_UI_UPDATES.md CACHE_CLEAR_GUIDE.md CACHE_OPTIMIZATION_VERIFICATION.md CACHE_SYNC_FIX.md CATEGORY_FIX_TODO.md CHANGELOG.md CHANGELOG_TODAY_NAVIGATION.md CLEANUP_COMPLETE.txt CLEANUP_SUMMARY.md CLOCK_IN_FIX.md CODE_FIXES_NEEDED.md COMPLETE_ERROR_FIX_SUMMARY.md COMPLETE_USER_SYSTEM_FIX.md COMPLETION_RATE_DEBUG_GUIDE.md COMPLETION_RATE_FIX.md COMPLETION_RATE_OPTIMIZATION.md COMPLETION_RATE_QUICK_REF.md COMPLETION_RATE_SUMMARY.md COMPLETION_SUMMARY.md CONFIRMATION_TOKEN_NULL_ERROR_FIX.md DAILY_DATA_SYNC_FIX.md DASHBOARD_CACHE_OPTIMIZATION.md DASHBOARD_HEIGHT_FIX.md DASHBOARD_OPTIMIZATION_REPORT.md DASHBOARD_QUICK_NAVIGATION.md DASHBOARD_SYNC_FIX.md DASHBOARD_UI_OPTIMIZATION.md DATABASE_ANALYSIS.md DATABASE_MIGRATION_COMPLETE.md DATABASE_RESTORE_SUMMARY.md DATA_CLEANUP_SUMMARY.md DATA_INSERTION_GUIDE.md DATA_SYNC_FIX.md DEBUGGING_GUIDE.md DEBUG_LOG_GUIDE.md DEBUG_MANAGER_WAREHOUSES.md DEBUG_PROFILE_IMAGE_LOADING.md DEBUG_RESET_PASSWORD.md DEBUG_VEHICLE_MANAGEMENT.md DEBUG_WAREHOUSE_SYNC.md DELETE_FIX_SUMMARY.md DELETE_NON_TEST_USERS_REPORT.md DISPLAY_LOGIC_FIX.md DRAFT_IMAGE_FIX_V2.md DRIVER_OPTIMIZATION_FEATURE.md DRIVER_PROFILE_SPLIT.md DRIVER_SUMMARY_FIX.md DRIVER_SUMMARY_OPTIMIZATION.md DRIVER_SUMMARY_QUICK_REF.md DRIVER_SUMMARY_RATE_OPTIMIZATION.md DRIVER_SUMMARY_RATE_QUICK_REF.md DRIVER_TYPE_FEATURE.md DRIVER_WAREHOUSE_DEBUG_GUIDE.md DUPLICATE_PHONE_ERROR_FIX.md ENHANCEMENT_SUMMARY.md ERROR_500_ANALYSIS.md ERROR_FIX_SUMMARY.md FEATURE_ADD_DRIVER_TYPE_SELECTION.md FEATURE_CHECKLIST.md FEATURE_COMPLETION_REPORT.md FEATURE_ENHANCEMENTS.md FEATURE_SUMMARY_v2.4.2.md FEATURE_TODAY_STATS_NAVIGATION.md FEATURE_VERIFICATION.md FINAL_FEATURE_REPORT.md FINAL_FIX_INSTRUCTIONS.md FINAL_FIX_SUMMARY.md FINAL_OPTIMIZATION_OVERVIEW.md FINAL_OPTIMIZATION_REPORT.md FINAL_STATUS.md FINAL_STATUS_SUMMARY.md FINAL_SUMMARY.md FINAL_UPDATE_2025_11_05.md FINAL_VERIFICATION.md FIXES_SUMMARY.md FIXES_SUMMARY_2025_11_05.md FIX_ADD_VEHICLE_UPLOAD_ERROR.md FIX_AUTH_PERMISSION_ISSUE.md FIX_CREATE_DRIVER_LOGIN_ACCOUNT.md FIX_DRAFT_IMAGE_PERSISTENCE.md FIX_DRIVER_TYPE_ENUM.md FIX_MANAGER_WAREHOUSE_DISPLAY.md FIX_MINIPROGRAM_RETURN_VEHICLE.md FIX_RESET_PASSWORD_ISSUE.md FIX_RETURN_VEHICLE_ERROR.md FIX_SUMMARY.md FIX_SUPER_ADMIN_INACTIVE_VEHICLES.md FIX_UPLOAD_AUTH_CHECK.md FIX_USECONTEXT_ERROR.md FIX_VEHICLE_HISTORY_LOGIC.md HIDE_LEASE_INFO_FOR_DRIVER.md HOW_TO_CHECK_LOGS.md HOW_TO_DEBUG_IMAGE_LOADING.md HOW_TO_VIEW_NOTIFICATIONS.md IMAGE_ERROR_FEEDBACK_SUCCESS.md IMAGE_ERROR_VISUAL_FEEDBACK.md IMAGE_LOADING_FIX.md IMAGE_LOADING_ROOT_CAUSE_FIX.md ISSUE_RESOLUTION.md LATEST_FIX.md LATEST_UI_UPDATE.md LEASE_ADMIN_ACCOUNT_UPDATE.md LEASE_ADMIN_SUMMARY.md LEASE_ADMIN_TODO.md LEASE_IMPLEMENTATION_TODO.md LEASE_SYSTEM_DESIGN.md LEASE_SYSTEM_REQUIREMENTS.md LEAVE_APPLICATION_FIX.md LEAVE_APPROVAL_NOTIFICATION_FIX.md LEAVE_CALCULATION_OPTIMIZATION.md LEAVE_ENHANCEMENT_PLAN.md LEAVE_FEATURE_CHECK.md LEAVE_NOTIFICATION_FINAL_FIX.md LEAVE_SYSTEM_ENHANCEMENT_PLAN.md LEAVE_SYSTEM_ENHANCEMENT_SUMMARY.md LEAVE_TYPE_ENUM_FIX.md LEAVE_TYPE_FIELD_FIX.md LOADING_ISSUE_FIX_REPORT.md LOGIN_ACCOUNT_UPDATE_FIX.md LOGIN_FIX_COMPLETE_SUMMARY.md LOGIN_FIX_FINAL.md LOGIN_FIX_SUMMARY.md LOGIN_OPTIMIZATION.md LOGIN_PAGE_STATUS.md LOGIN_TEST_GUIDE.md LOGOUT_BUTTON_FIX.md MANAGER_DRIVER_MANAGEMENT.md MANAGER_HOME_DATA_FIX.md MISSING_PROFILE_FIX.md MULTI_TENANT_ARCHITECTURE.md MULTI_TENANT_FIX_406_COMPLETE.md MULTI_TENANT_FIX_406_ERROR.md MULTI_TENANT_GUIDE.md MULTI_TENANT_IMPLEMENTATION.md MULTI_TENANT_IMPLEMENTATION_COMPLETE.md MULTI_TENANT_QUICKSTART.md MULTI_TENANT_TEST_GUIDE.md MULTI_TENANT_TODO.md MULTI_TENANT_USAGE.md NEW_DRIVER_TAG_LOGIC.md NOTIFICATION_BELL_FEATURE.md NOTIFICATION_CATEGORY_FIX.md NOTIFICATION_DEBUG_GUIDE.md NOTIFICATION_DELETE_COMPLETE_FIX.md NOTIFICATION_DELETE_FIX.md NOTIFICATION_DELETE_PERMISSION_FIX.md NOTIFICATION_DISPLAY_FORMAT_FIX.md NOTIFICATION_DISPLAY_OPTIMIZATION.md NOTIFICATION_FIX.md NOTIFICATION_FIX_SUMMARY.md NOTIFICATION_FORMAT_TEST_GUIDE.md NOTIFICATION_OPERATOR_NAME_FIX.md NOTIFICATION_OPTIMIZATION.md NOTIFICATION_OPTIMIZATION_SUMMARY.md NOTIFICATION_POLLING_TEST_GUIDE.md NOTIFICATION_REALTIME_UPDATE.md NOTIFICATION_RLS_FIX.md NOTIFICATION_SCROLL_TEST_GUIDE.md NOTIFICATION_STATUS_UPDATE_FIX.md NOTIFICATION_SUMMARY.md NOTIFICATION_SYSTEM.md NOTIFICATION_SYSTEM_COMPLETE_FIX.md OCR#U8bc6#U522b#U7f51#U7edc#U9519#U8bef#U5904#U7406#U4f18#U5316.md OCR#U8bc6#U522bJSON#U89e3#U6790#U4f18#U5316.md ONE_CLICK_LOCK_FEATURE.md OPERATOR_NAME_TEST_GUIDE.md OPTIMIZATION_CHECKLIST.md PASSWORD_CHANGE_FEATURE.md PERCENTAGE_DISPLAY_FIX.md PERFORMANCE_OPTIMIZATION_SUMMARY.md PHONE_CONFLICT_FINAL_FIX.md PHONE_CONFLICT_FIX_V2.md PHONE_CONFLICT_FIX_V3.md PHONE_LOGIN_FEATURE.md PICKUP_PHOTOS_SEPARATION_FIX.md PIECE_WORK_DATA_REFRESH_FIX.md PROFILES_RLS_ENABLED.md PROFILE_IMAGE_FIX_FINAL.md PROFILE_NOT_FOUND_DEBUG.md PROFILE_VEHICLE_INFO_INTEGRATION.md PULL_DOWN_REFRESH_FEATURE.md QUICK_DEMO_v2.4.2.md QUICK_FIX.md QUICK_FIX_GUIDE.md QUICK_FIX_SUMMARY.md QUICK_LOGIN_GUIDE.md QUICK_REFERENCE.md QUICK_START.md QUICK_TEST_CREATE_TENANT.md QUICK_TEST_GUIDE.md QUICK_TEST_VERIFICATION_CODE_LOGIN.md README.md REALTIME_CONNECTION_ISSUE.md REALTIME_NOTIFICATIONS.md REALTIME_SUBSCRIPTION_FIX.md REALTIME_SYNC_IMPLEMENTATION.md REALTIME_SYNC_SUMMARY.md REALTIME_UPDATE_FIX.md REALTIME_UPDATE_TEST_GUIDE.md REFACTORING_COMPLETE.md REFACTORING_SUMMARY.md RENTAL_EDIT_FIX.md RENTAL_FEATURE_TEST.md RENTAL_INFO_SUMMARY.md RESET_PASSWORD_FINAL_SOLUTION.md RESET_PASSWORD_TROUBLESHOOTING.md RESIGNATION_DATE_FIX.md REVIEW_AUTO_LOCK_OPTIMIZATION.md REVIEW_FIELDS_FIX.md REVIEW_INPUT_FIX.md RLS#U4fee#U590d#U5b9e#U65bd#U6307#U5357.md RLS#U4fee#U590d#U9a8c#U8bc1#U62a5#U544a.md RLS#U7b56#U7565#U5ba1#U67e5#U603b#U7ed3.md RLS_INFINITE_RECURSION_FIX.md RLS_POLICY_AUDIT_REPORT.md ROLE_BASED_LOGIN_TEST.md ROLE_NAME_CHANGES.md SHOW_ALL_DRIVERS_FIX.md STATUS_LABELS_DEMO.md SUMMARY_2025_11_05_DRIVER_LEAVE_BUTTON_FIX.md SUMMARY_2025_11_05_NOTIFICATION_CENTER_UNREAD_FILTER.md SUMMARY_DRIVER_OPTIMIZATION.md SUPER_ADMIN_DATA_DEBUG.md SUPER_ADMIN_PERMISSION_FIX.md SWIPE_BACK_FEATURE.md SYNC_FIX_SUMMARY.md TESTING_GUIDE.md TEST_ACCOUNTS.md TEST_CHECKLIST_v2.4.2.md TEST_DRIVER_ACCOUNT.md TEST_GUIDE.md TEST_NOTIFICATION_FIX.md TEST_NOTIFICATION_REAL_NAME.md TEST_NOTIFICATION_REMOVAL.md TEST_PHONE_PASSWORD_LOGIN.md TEST_TODAY_NAVIGATION.md TIMEZONE_FIX.md TODO.md TODO_#U4e2a#U4eba#U4e2d#U5fc3#U529f#U80fd.md TROUBLESHOOTING.md UI_CLEANUP.md UI_LOADING_OPTIMIZATION.md UI_OPTIMIZATION_SUMMARY.md UI_SIZE_OPTIMIZATION.md USER_CREATION_AND_LOGIN_OPTIMIZATION.md USER_CREATION_DIAGNOSIS.md USER_CREATION_OPTIMIZATION.md USER_GUIDE_LEAVE_SYSTEM.md USER_GUIDE_LEAVE_SYSTEM_V2.md USER_LOGIN_FIX_COMPLETE.md USER_MANAGEMENT_FEATURE.md USER_MANAGEMENT_FIXES_SUMMARY.md USER_MANAGEMENT_UI_OPTIMIZATION.md USER_PROFILE_OPTIMIZATION.md VEHICLE_DELETE_FEATURE.md VEHICLE_DETAIL_FIX.md VEHICLE_HISTORY_COMPLETE_FIX.md VEHICLE_HISTORY_DAMAGE_PHOTOS.md VEHICLE_HISTORY_DRIVER_INFO.md VEHICLE_LEASE_INTEGRATION_COMPLETE.md VEHICLE_LEASE_MANAGEMENT_FEATURE.md VEHICLE_LIST_LEASE_INFO_UPDATE.md VEHICLE_MANAGEMENT_UPDATE.md VEHICLE_PICKUP_RETURN_PLAN.md VEHICLE_RENTAL_FEATURE.md VEHICLE_REVIEW_IMPLEMENTATION_SUMMARY.md VEHICLE_REVIEW_INTEGRATION.md VEHICLE_REVIEW_PLAN.md VEHICLE_REVIEW_REMOVAL.md VEHICLE_REVIEW_WORKFLOW.md VERIFICATION_CHECKLIST.md VERIFICATION_CODE_LOGIN_COMPLETE_FIX.md VERIFICATION_CODE_LOGIN_FIX.md VERIFICATION_REPORT.md WAREHOUSE_ASSIGNMENT_NOTIFICATION_COMPLETE.md WAREHOUSE_ASSIGNMENT_NOTIFICATION_DEBUG.md WAREHOUSE_ASSIGNMENT_NOTIFICATION_FIX.md WAREHOUSE_ASSIGNMENT_SYNC_FIX.md WAREHOUSE_NOTIFICATION_COMPLETE_FIX.md WAREHOUSE_NOTIFICATION_TEST_GUIDE.md WAREHOUSE_OPTIMIZATION.md WAREHOUSE_PERMISSION_FIX_REPORT.md WAREHOUSE_PERMISSION_FIX_SUMMARY.md WAREHOUSE_PERMISSION_TEST_GUIDE.md WAREHOUSE_SYNC_TEST_GUIDE.md WAREHOUSE_SYSTEM_OPTIMIZATION.md WEB-ADMIN-TODO.md WEB-TODO.md WEBSOCKET_ERROR_FIX.md apply_migrations.sh babel.config.js biome.json build.sh check-reset-password.sql check-user-consistency.sql check-user-data.sql clear-cache.sh config dist docs history node_modules package.json pnpm-lock.yaml pnpm-workspace.yaml postcss.config.js project.config.json project.private.config.json query-all-users.sql rules scripts sgconfig.yml src supabase tailwind.config.js test-database.md tsconfig.check.json tsconfig.json 上次选择的仓库 基于小程序的电脑端管理方案.md 如何访问电脑端管理后台.md 显示确认对话框 更新选择 电脑端管理后台创建完成.md 电脑端管理后台完成总结.md 电脑端管理后台开发进度.md 电脑端管理后台技术方案.md 电脑端管理后台访问指南.md 电脑端管理后台部署说明.md 电脑端管理后台配置和访问指南.md 电脑端管理方案.md 电脑端访问诊断.md 第一个仓库 email_confirmed_at，confirmed_at 会自动生成。

## 解决方案
\#U4ed3#U5e93#U663e#U793a#U4f18#U5316#U603b#U7ed3.md \#U4f18#U5316#U5b8c#U6210_#U7ba1#U7406#U7aef#U8bf7#U5047#U5ba1#U6279#U548c#U6253#U5361#U8bb0#U5f55.md \#U4f18#U5316#U8f66#U8f86#U7ba1#U7406#U5f55#U5165#U4f53#U9a8c.md \#U4fdd#U5b58#U5931#U8d25#U9519#U8bef#U6392#U67e5#U6307#U5357.md \#U4fee#U590d#U56fe#U7247#U663e#U793a#U95ee#U9898.md \#U4fee#U590d#U5b8c#U6210_#U4ed3#U5e93#U7ba1#U7406#U529f#U80fd.md \#U4fee#U590dwarehouse_id#U7ea6#U675f#U9519#U8bef.md \#U529f#U80fd#U4f18#U5316#U603b#U7ed3#U62a5#U544a.md \#U53f8#U673a#U7aef#U54c1#U7c7b#U81ea#U52a8#U9501#U5b9a#U529f#U80fd#U6d4b#U8bd5#U6307#U5357.md \#U53f8#U673a#U7aef#U8003#U52e4#U6253#U5361#U95ee#U9898#U4fee#U590d#U603b#U7ed3.md \#U53f8#U673a#U7c7b#U578b#U663e#U793a#U95ee#U9898#U6392#U67e5#U6307#U5357.md \#U53f8#U673a#U7c7b#U578b#U7cfb#U7edf#U91cd#U6784#U8bf4#U660e.md \#U53f8#U673a#U7c7b#U578b#U7f16#U8f91#U4fee#U590d#U9a8c#U8bc1#U6307#U5357.md \#U53f8#U673a#U7c7b#U578b#U7f16#U8f91#U95ee#U9898#U4fee#U590d#U603b#U7ed3.md \#U53f8#U673a#U7c7b#U578b#U8c03#U8bd5#U6307#U5357.md \#U53f8#U673a#U7edf#U8ba1#U529f#U80fd#U5b9e#U73b0#U603b#U7ed3.md \#U53f8#U673a#U7edf#U8ba1#U6807#U7b7e#U9875#U6253#U5361#U6570#U636e#U4e0d#U663e#U793a#U95ee#U9898#U4fee#U590d#U8bf4#U660e.md \#U540c#U6b65#U4ee3#U7801#U4fee#U590d#U603b#U7ed3.md \#U540c#U6b65#U4ee3#U7801#U5ba1#U67e5#U62a5#U544a.md \#U56fe#U7247#U4e0a#U4f20#U517c#U5bb9#U6027#U95ee#U9898#U4fee#U590d#U603b#U7ed3.md \#U56fe#U7247#U81ea#U52a8#U6a2a#U5411#U65cb#U8f6c#U529f#U80fd#U8bf4#U660e.md \#U5feb#U901f#U8c03#U8bd5#U6307#U5357.md \#U6253#U5361#U8bb0#U5f55#U7b5b#U9009#U6761#U4ef6#U4f18#U5316#U8bf4#U660e.md \#U6253#U5361#U8bb0#U5f55#U96c6#U6210#U5230#U5ba1#U6279#U9875#U9762.md \#U667a#U80fd#U7f13#U5b58#U529f#U80fd#U8bf4#U660e.md \#U6743#U9650#U5206#U914d#U4fee#U590d#U8bf4#U660e.md \#U6d4b#U8bd5#U6307#U5357_#U4ed3#U5e93#U7981#U7528#U542f#U7528#U529f#U80fd.md \#U6d4b#U8bd5#U9a8c#U8bc1#U8bf4#U660e.md \#U6dfb#U52a0#U9a7e#U9a76#U5458#U4fe1#U606f#U5c55#U793a.md \#U7528#U6237#U8be6#U60c5#U9875#U9762#U529f#U80fd#U8bf4#U660e.md \#U7528#U6237#U8be6#U60c5#U9875#U9762#U529f#U80fd#U9a8c#U8bc1.md \#U7528#U6237#U8be6#U60c5#U9875#U9762#U589e#U5f3a#U8bf4#U660e.md \#U7b5b#U9009#U533a#U57dfUI#U4f18#U5316#U8bf4#U660e.md \#U8003#U52e4#U7ba1#U7406#U529f#U80fd#U4f18#U5316#U5b8c#U6210#U62a5#U544a.md \#U8003#U52e4#U7ba1#U7406#U9875#U9762#U6574#U5408#U8bf4#U660e.md \#U8003#U52e4#U89c4#U5219#U67e5#U8be2#U9519#U8bef#U4fee#U590d#U8bf4#U660e.md \#U884c#U9a76#U8bc1#U526f#U9875#U80cc#U9875#U68c0#U9a8c#U6709#U6548#U671f#U8bc6#U522b#U4f18#U5316.md \#U884c#U9a76#U8bc1#U62cd#U7167#U95ee#U9898#U8c03#U8bd5#U6307#U5357.md \#U884c#U9a76#U8bc1#U8bc6#U522b#U529f#U80fd#U4fee#U590d#U8bf4#U660e.md \#U884c#U9a76#U8bc1#U8bc6#U522b#U529f#U80fd#U5b8c#U6574#U4fee#U590d#U603b#U7ed3.md \#U89d2#U8272#U7ba1#U7406#U529f#U80fd#U8bf4#U660e.md \#U8d85#U7ea7#U7ba1#U7406#U5458#U8003#U52e4#U7ba1#U7406#U6570#U636e#U52a0#U8f7d#U95ee#U9898#U4fee#U590d#U8bf4#U660e.md \#U8d85#U7ea7#U7ba1#U7406#U7aef#U8003#U52e4#U7ba1#U7406#U4f18#U5316.md \#U8d85#U7ea7#U7ba1#U7406#U7aef#U8f66#U8f86#U7ba1#U7406#U529f#U80fd#U8bf4#U660e.md \#U8f66#U8f86#U5217#U8868#U7ade#U6001#U6761#U4ef6#U4fee#U590d#U8bf4#U660e.md \#U8f66#U8f86#U6dfb#U52a0#U529f#U80fd#U9519#U8bef#U4fee#U590d.md \#U8f66#U8f86#U7167#U7247#U529f#U80fd#U4fee#U590d#U8bf4#U660e.md \#U8f66#U8f86#U7ba1#U7406#U529f#U80fd#U5b9e#U73b0#U65b9#U6848.md \#U8f66#U8f86#U7ba1#U7406#U529f#U80fd#U8bf4#U660e.md \#U8f66#U8f86#U7ba1#U7406UI#U4f18#U5316#U8bf4#U660e.md \#U8fbe#U6807#U7387#U4fee#U590d#U603b#U7ed3.md \#U8fbe#U6807#U7387#U7b97#U6cd5#U68c0#U67e5#U62a5#U544a.md \#U95ee#U9898#U4fee#U590d#U603b#U7ed3.md .editorconfig .env .env.development .env.production .env.test .git .gitignore .swc .sync ACCOUNT_FIX_SUMMARY.md ACCOUNT_RESET_SUMMARY.md ADD_DRIVER_FEATURE.md ADMIN2_ACCOUNT_CREATED.md ADMIN_ACCOUNTS.md ALL_ACCOUNTS.md ALL_FIXES_SUMMARY.md APPLICATION_DETAIL_FEATURE.md ATTENDANCE_CACHE_OPTIMIZATION.md ATTENDANCE_CHECK_FEATURE.md ATTENDANCE_DISPLAY_FIX.md ATTENDANCE_ENHANCEMENT.md ATTENDANCE_FINAL_SUMMARY.md ATTENDANCE_FINAL_UPDATE.md ATTENDANCE_FIXES_SUMMARY.md ATTENDANCE_FIX_SUMMARY.md ATTENDANCE_OPTIMIZATION.md ATTENDANCE_RATE_FEATURE.md ATTENDANCE_RATE_FINAL_UPDATE.md ATTENDANCE_RATE_QUICK_REF.md ATTENDANCE_RATE_SUMMARY.md ATTENDANCE_RATE_TEST.md ATTENDANCE_RATE_VERIFICATION.md ATTENDANCE_SHOW_ALL_DRIVERS_FIX.md ATTENDANCE_SIMPLIFICATION.md ATTENDANCE_STATUS_LABELS.md ATTENDANCE_UPDATE_SUMMARY.md AUTH_FIX_REPORT.md BADGE_POSITION_FIX.md BUGFIX_#U4ed3#U5e93#U7981#U7528#U540e#U65e0#U6cd5#U91cd#U65b0#U542f#U7528.md BUGFIX_#U53f8#U673a#U6253#U5361#U95ee#U9898.md BUGFIX_PROFILE_IMAGE_LOADING.md BUTTON_DISPLAY_FIX.md CACHE_AND_UI_UPDATES.md CACHE_CLEAR_GUIDE.md CACHE_OPTIMIZATION_VERIFICATION.md CACHE_SYNC_FIX.md CATEGORY_FIX_TODO.md CHANGELOG.md CHANGELOG_TODAY_NAVIGATION.md CLEANUP_COMPLETE.txt CLEANUP_SUMMARY.md CLOCK_IN_FIX.md CODE_FIXES_NEEDED.md COMPLETE_ERROR_FIX_SUMMARY.md COMPLETE_USER_SYSTEM_FIX.md COMPLETION_RATE_DEBUG_GUIDE.md COMPLETION_RATE_FIX.md COMPLETION_RATE_OPTIMIZATION.md COMPLETION_RATE_QUICK_REF.md COMPLETION_RATE_SUMMARY.md COMPLETION_SUMMARY.md CONFIRMATION_TOKEN_NULL_ERROR_FIX.md DAILY_DATA_SYNC_FIX.md DASHBOARD_CACHE_OPTIMIZATION.md DASHBOARD_HEIGHT_FIX.md DASHBOARD_OPTIMIZATION_REPORT.md DASHBOARD_QUICK_NAVIGATION.md DASHBOARD_SYNC_FIX.md DASHBOARD_UI_OPTIMIZATION.md DATABASE_ANALYSIS.md DATABASE_MIGRATION_COMPLETE.md DATABASE_RESTORE_SUMMARY.md DATA_CLEANUP_SUMMARY.md DATA_INSERTION_GUIDE.md DATA_SYNC_FIX.md DEBUGGING_GUIDE.md DEBUG_LOG_GUIDE.md DEBUG_MANAGER_WAREHOUSES.md DEBUG_PROFILE_IMAGE_LOADING.md DEBUG_RESET_PASSWORD.md DEBUG_VEHICLE_MANAGEMENT.md DEBUG_WAREHOUSE_SYNC.md DELETE_FIX_SUMMARY.md DELETE_NON_TEST_USERS_REPORT.md DISPLAY_LOGIC_FIX.md DRAFT_IMAGE_FIX_V2.md DRIVER_OPTIMIZATION_FEATURE.md DRIVER_PROFILE_SPLIT.md DRIVER_SUMMARY_FIX.md DRIVER_SUMMARY_OPTIMIZATION.md DRIVER_SUMMARY_QUICK_REF.md DRIVER_SUMMARY_RATE_OPTIMIZATION.md DRIVER_SUMMARY_RATE_QUICK_REF.md DRIVER_TYPE_FEATURE.md DRIVER_WAREHOUSE_DEBUG_GUIDE.md DUPLICATE_PHONE_ERROR_FIX.md ENHANCEMENT_SUMMARY.md ERROR_500_ANALYSIS.md ERROR_FIX_SUMMARY.md FEATURE_ADD_DRIVER_TYPE_SELECTION.md FEATURE_CHECKLIST.md FEATURE_COMPLETION_REPORT.md FEATURE_ENHANCEMENTS.md FEATURE_SUMMARY_v2.4.2.md FEATURE_TODAY_STATS_NAVIGATION.md FEATURE_VERIFICATION.md FINAL_FEATURE_REPORT.md FINAL_FIX_INSTRUCTIONS.md FINAL_FIX_SUMMARY.md FINAL_OPTIMIZATION_OVERVIEW.md FINAL_OPTIMIZATION_REPORT.md FINAL_STATUS.md FINAL_STATUS_SUMMARY.md FINAL_SUMMARY.md FINAL_UPDATE_2025_11_05.md FINAL_VERIFICATION.md FIXES_SUMMARY.md FIXES_SUMMARY_2025_11_05.md FIX_ADD_VEHICLE_UPLOAD_ERROR.md FIX_AUTH_PERMISSION_ISSUE.md FIX_CREATE_DRIVER_LOGIN_ACCOUNT.md FIX_DRAFT_IMAGE_PERSISTENCE.md FIX_DRIVER_TYPE_ENUM.md FIX_MANAGER_WAREHOUSE_DISPLAY.md FIX_MINIPROGRAM_RETURN_VEHICLE.md FIX_RESET_PASSWORD_ISSUE.md FIX_RETURN_VEHICLE_ERROR.md FIX_SUMMARY.md FIX_SUPER_ADMIN_INACTIVE_VEHICLES.md FIX_UPLOAD_AUTH_CHECK.md FIX_USECONTEXT_ERROR.md FIX_VEHICLE_HISTORY_LOGIC.md HIDE_LEASE_INFO_FOR_DRIVER.md HOW_TO_CHECK_LOGS.md HOW_TO_DEBUG_IMAGE_LOADING.md HOW_TO_VIEW_NOTIFICATIONS.md IMAGE_ERROR_FEEDBACK_SUCCESS.md IMAGE_ERROR_VISUAL_FEEDBACK.md IMAGE_LOADING_FIX.md IMAGE_LOADING_ROOT_CAUSE_FIX.md ISSUE_RESOLUTION.md LATEST_FIX.md LATEST_UI_UPDATE.md LEASE_ADMIN_ACCOUNT_UPDATE.md LEASE_ADMIN_SUMMARY.md LEASE_ADMIN_TODO.md LEASE_IMPLEMENTATION_TODO.md LEASE_SYSTEM_DESIGN.md LEASE_SYSTEM_REQUIREMENTS.md LEAVE_APPLICATION_FIX.md LEAVE_APPROVAL_NOTIFICATION_FIX.md LEAVE_CALCULATION_OPTIMIZATION.md LEAVE_ENHANCEMENT_PLAN.md LEAVE_FEATURE_CHECK.md LEAVE_NOTIFICATION_FINAL_FIX.md LEAVE_SYSTEM_ENHANCEMENT_PLAN.md LEAVE_SYSTEM_ENHANCEMENT_SUMMARY.md LEAVE_TYPE_ENUM_FIX.md LEAVE_TYPE_FIELD_FIX.md LOADING_ISSUE_FIX_REPORT.md LOGIN_ACCOUNT_UPDATE_FIX.md LOGIN_FIX_COMPLETE_SUMMARY.md LOGIN_FIX_FINAL.md LOGIN_FIX_SUMMARY.md LOGIN_OPTIMIZATION.md LOGIN_PAGE_STATUS.md LOGIN_TEST_GUIDE.md LOGOUT_BUTTON_FIX.md MANAGER_DRIVER_MANAGEMENT.md MANAGER_HOME_DATA_FIX.md MISSING_PROFILE_FIX.md MULTI_TENANT_ARCHITECTURE.md MULTI_TENANT_FIX_406_COMPLETE.md MULTI_TENANT_FIX_406_ERROR.md MULTI_TENANT_GUIDE.md MULTI_TENANT_IMPLEMENTATION.md MULTI_TENANT_IMPLEMENTATION_COMPLETE.md MULTI_TENANT_QUICKSTART.md MULTI_TENANT_TEST_GUIDE.md MULTI_TENANT_TODO.md MULTI_TENANT_USAGE.md NEW_DRIVER_TAG_LOGIC.md NOTIFICATION_BELL_FEATURE.md NOTIFICATION_CATEGORY_FIX.md NOTIFICATION_DEBUG_GUIDE.md NOTIFICATION_DELETE_COMPLETE_FIX.md NOTIFICATION_DELETE_FIX.md NOTIFICATION_DELETE_PERMISSION_FIX.md NOTIFICATION_DISPLAY_FORMAT_FIX.md NOTIFICATION_DISPLAY_OPTIMIZATION.md NOTIFICATION_FIX.md NOTIFICATION_FIX_SUMMARY.md NOTIFICATION_FORMAT_TEST_GUIDE.md NOTIFICATION_OPERATOR_NAME_FIX.md NOTIFICATION_OPTIMIZATION.md NOTIFICATION_OPTIMIZATION_SUMMARY.md NOTIFICATION_POLLING_TEST_GUIDE.md NOTIFICATION_REALTIME_UPDATE.md NOTIFICATION_RLS_FIX.md NOTIFICATION_SCROLL_TEST_GUIDE.md NOTIFICATION_STATUS_UPDATE_FIX.md NOTIFICATION_SUMMARY.md NOTIFICATION_SYSTEM.md NOTIFICATION_SYSTEM_COMPLETE_FIX.md OCR#U8bc6#U522b#U7f51#U7edc#U9519#U8bef#U5904#U7406#U4f18#U5316.md OCR#U8bc6#U522bJSON#U89e3#U6790#U4f18#U5316.md ONE_CLICK_LOCK_FEATURE.md OPERATOR_NAME_TEST_GUIDE.md OPTIMIZATION_CHECKLIST.md PASSWORD_CHANGE_FEATURE.md PERCENTAGE_DISPLAY_FIX.md PERFORMANCE_OPTIMIZATION_SUMMARY.md PHONE_CONFLICT_FINAL_FIX.md PHONE_CONFLICT_FIX_V2.md PHONE_CONFLICT_FIX_V3.md PHONE_LOGIN_FEATURE.md PICKUP_PHOTOS_SEPARATION_FIX.md PIECE_WORK_DATA_REFRESH_FIX.md PROFILES_RLS_ENABLED.md PROFILE_IMAGE_FIX_FINAL.md PROFILE_NOT_FOUND_DEBUG.md PROFILE_VEHICLE_INFO_INTEGRATION.md PULL_DOWN_REFRESH_FEATURE.md QUICK_DEMO_v2.4.2.md QUICK_FIX.md QUICK_FIX_GUIDE.md QUICK_FIX_SUMMARY.md QUICK_LOGIN_GUIDE.md QUICK_REFERENCE.md QUICK_START.md QUICK_TEST_CREATE_TENANT.md QUICK_TEST_GUIDE.md QUICK_TEST_VERIFICATION_CODE_LOGIN.md README.md REALTIME_CONNECTION_ISSUE.md REALTIME_NOTIFICATIONS.md REALTIME_SUBSCRIPTION_FIX.md REALTIME_SYNC_IMPLEMENTATION.md REALTIME_SYNC_SUMMARY.md REALTIME_UPDATE_FIX.md REALTIME_UPDATE_TEST_GUIDE.md REFACTORING_COMPLETE.md REFACTORING_SUMMARY.md RENTAL_EDIT_FIX.md RENTAL_FEATURE_TEST.md RENTAL_INFO_SUMMARY.md RESET_PASSWORD_FINAL_SOLUTION.md RESET_PASSWORD_TROUBLESHOOTING.md RESIGNATION_DATE_FIX.md REVIEW_AUTO_LOCK_OPTIMIZATION.md REVIEW_FIELDS_FIX.md REVIEW_INPUT_FIX.md RLS#U4fee#U590d#U5b9e#U65bd#U6307#U5357.md RLS#U4fee#U590d#U9a8c#U8bc1#U62a5#U544a.md RLS#U7b56#U7565#U5ba1#U67e5#U603b#U7ed3.md RLS_INFINITE_RECURSION_FIX.md RLS_POLICY_AUDIT_REPORT.md ROLE_BASED_LOGIN_TEST.md ROLE_NAME_CHANGES.md SHOW_ALL_DRIVERS_FIX.md STATUS_LABELS_DEMO.md SUMMARY_2025_11_05_DRIVER_LEAVE_BUTTON_FIX.md SUMMARY_2025_11_05_NOTIFICATION_CENTER_UNREAD_FILTER.md SUMMARY_DRIVER_OPTIMIZATION.md SUPER_ADMIN_DATA_DEBUG.md SUPER_ADMIN_PERMISSION_FIX.md SWIPE_BACK_FEATURE.md SYNC_FIX_SUMMARY.md TESTING_GUIDE.md TEST_ACCOUNTS.md TEST_CHECKLIST_v2.4.2.md TEST_DRIVER_ACCOUNT.md TEST_GUIDE.md TEST_NOTIFICATION_FIX.md TEST_NOTIFICATION_REAL_NAME.md TEST_NOTIFICATION_REMOVAL.md TEST_PHONE_PASSWORD_LOGIN.md TEST_TODAY_NAVIGATION.md TIMEZONE_FIX.md TODO.md TODO_#U4e2a#U4eba#U4e2d#U5fc3#U529f#U80fd.md TROUBLESHOOTING.md UI_CLEANUP.md UI_LOADING_OPTIMIZATION.md UI_OPTIMIZATION_SUMMARY.md UI_SIZE_OPTIMIZATION.md USER_CREATION_AND_LOGIN_OPTIMIZATION.md USER_CREATION_DIAGNOSIS.md USER_CREATION_OPTIMIZATION.md USER_GUIDE_LEAVE_SYSTEM.md USER_GUIDE_LEAVE_SYSTEM_V2.md USER_LOGIN_FIX_COMPLETE.md USER_MANAGEMENT_FEATURE.md USER_MANAGEMENT_FIXES_SUMMARY.md USER_MANAGEMENT_UI_OPTIMIZATION.md USER_PROFILE_OPTIMIZATION.md VEHICLE_DELETE_FEATURE.md VEHICLE_DETAIL_FIX.md VEHICLE_HISTORY_COMPLETE_FIX.md VEHICLE_HISTORY_DAMAGE_PHOTOS.md VEHICLE_HISTORY_DRIVER_INFO.md VEHICLE_LEASE_INTEGRATION_COMPLETE.md VEHICLE_LEASE_MANAGEMENT_FEATURE.md VEHICLE_LIST_LEASE_INFO_UPDATE.md VEHICLE_MANAGEMENT_UPDATE.md VEHICLE_PICKUP_RETURN_PLAN.md VEHICLE_RENTAL_FEATURE.md VEHICLE_REVIEW_IMPLEMENTATION_SUMMARY.md VEHICLE_REVIEW_INTEGRATION.md VEHICLE_REVIEW_PLAN.md VEHICLE_REVIEW_REMOVAL.md VEHICLE_REVIEW_WORKFLOW.md VERIFICATION_CHECKLIST.md VERIFICATION_CODE_LOGIN_COMPLETE_FIX.md VERIFICATION_CODE_LOGIN_FIX.md VERIFICATION_REPORT.md WAREHOUSE_ASSIGNMENT_NOTIFICATION_COMPLETE.md WAREHOUSE_ASSIGNMENT_NOTIFICATION_DEBUG.md WAREHOUSE_ASSIGNMENT_NOTIFICATION_FIX.md WAREHOUSE_ASSIGNMENT_SYNC_FIX.md WAREHOUSE_NOTIFICATION_COMPLETE_FIX.md WAREHOUSE_NOTIFICATION_TEST_GUIDE.md WAREHOUSE_OPTIMIZATION.md WAREHOUSE_PERMISSION_FIX_REPORT.md WAREHOUSE_PERMISSION_FIX_SUMMARY.md WAREHOUSE_PERMISSION_TEST_GUIDE.md WAREHOUSE_SYNC_TEST_GUIDE.md WAREHOUSE_SYSTEM_OPTIMIZATION.md WEB-ADMIN-TODO.md WEB-TODO.md WEBSOCKET_ERROR_FIX.md apply_migrations.sh babel.config.js biome.json build.sh check-reset-password.sql check-user-consistency.sql check-user-data.sql clear-cache.sh config dist docs history node_modules package.json pnpm-lock.yaml pnpm-workspace.yaml postcss.config.js project.config.json project.private.config.json query-all-users.sql rules scripts sgconfig.yml src supabase tailwind.config.js test-database.md tsconfig.check.json tsconfig.json 上次选择的仓库 基于小程序的电脑端管理方案.md 如何访问电脑端管理后台.md 显示确认对话框 更新选择 电脑端管理后台创建完成.md 电脑端管理后台完成总结.md 电脑端管理后台开发进度.md 电脑端管理后台技术方案.md 电脑端管理后台访问指南.md 电脑端管理后台部署说明.md 电脑端管理后台配置和访问指南.md 电脑端管理方案.md 电脑端访问诊断.md 第一个仓库 email_confirmed_at 字段。
*/

-- 重新创建自动确认用户邮箱的函数
CREATE OR REPLACE FUNCTION confirm_user_email(user_id uuid)
RETURNS void
LANGUAGE plpgsql
SECURITY DEFINER
SET search_path = public
AS $$
BEGIN
  -- 更新 auth.users 表，设置邮箱已确认
  -- confirmed_at 是生成列，会自动根据 email_confirmed_at 生成
  UPDATE auth.users
  SET email_confirmed_at = NOW()
  WHERE id = user_id
    AND email_confirmed_at IS NULL;  -- 只更新未确认的用户
END;
$$;
