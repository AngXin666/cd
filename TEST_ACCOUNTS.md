# 测试账号信息

## 📋 概述

系统已成功创建5个测试租户和对应的用户账号，用于测试多租户功能。

## 🏢 租户列表

### 租户 1：顺丰物流
- **租户代码**：`tenant-001`
- **公司名称**：顺丰物流
- **联系人**：张三
- **联系电话**：13800000001
- **联系邮箱**：zhangsan@sf-express.com
- **状态**：✅ 正常
- **配额**：
  - 最大用户数：50
  - 最大车辆数：100
- **有效期**：2025-11-27 至 2026-11-27
- **启用模块**：
  - ✅ 车辆管理
  - ✅ 考勤管理
  - ✅ 仓库管理

### 租户 2：京东物流
- **租户代码**：`tenant-002`
- **公司名称**：京东物流
- **联系人**：李四
- **联系电话**：13800000002
- **联系邮箱**：lisi@jd.com
- **状态**：✅ 正常
- **配额**：
  - 最大用户数：50
  - 最大车辆数：100
- **有效期**：2025-11-27 至 2026-11-27
- **启用模块**：
  - ✅ 车辆管理
  - ✅ 考勤管理
  - ✅ 仓库管理

### 租户 3：德邦快递
- **租户代码**：`tenant-003`
- **公司名称**：德邦快递
- **联系人**：王五
- **联系电话**：13800000003
- **联系邮箱**：wangwu@deppon.com
- **状态**：✅ 正常
- **配额**：
  - 最大用户数：50
  - 最大车辆数：100
- **有效期**：2025-11-27 至 2026-11-27
- **启用模块**：
  - ✅ 车辆管理
  - ✅ 考勤管理
  - ✅ 仓库管理

### 租户 4：中通快递
- **租户代码**：`tenant-004`
- **公司名称**：中通快递
- **联系人**：赵六
- **联系电话**：13800000004
- **联系邮箱**：zhaoliu@zto.com
- **状态**：✅ 正常
- **配额**：
  - 最大用户数：50
  - 最大车辆数：100
- **有效期**：2025-11-27 至 2026-11-27
- **启用模块**：
  - ✅ 车辆管理
  - ✅ 考勤管理
  - ✅ 仓库管理

### 租户 5：圆通速递
- **租户代码**：`tenant-005`
- **公司名称**：圆通速递
- **联系人**：孙七
- **联系电话**：13800000005
- **联系邮箱**：sunqi@yto.com
- **状态**：✅ 正常
- **配额**：
  - 最大用户数：50
  - 最大车辆数：100
- **有效期**：2025-11-27 至 2026-11-27
- **启用模块**：
  - ✅ 车辆管理
  - ✅ 考勤管理
  - ✅ 仓库管理

## 👤 用户账号

### 租户老板账号

所有租户老板账号的密码都是：**`password123`**

| 租户 | 姓名 | 手机号 | 邮箱 | 角色 | 状态 |
|------|------|--------|------|------|------|
| 顺丰物流 | 张三 | 13800000001 | zhangsan@sf-express.com | boss | ✅ 正常 |
| 京东物流 | 李四 | 13800000002 | lisi@jd.com | boss | ✅ 正常 |
| 德邦快递 | 王五 | 13800000003 | wangwu@deppon.com | boss | ✅ 正常 |
| 中通快递 | 赵六 | 13800000004 | zhaoliu@zto.com | boss | ✅ 正常 |
| 圆通速递 | 孙七 | 13800000005 | sunqi@yto.com | boss | ✅ 正常 |

### 系统管理员账号

| 姓名 | 邮箱 | 手机号 | 密码 | 角色 | 状态 |
|------|------|--------|------|------|------|
| 系统管理员 | admin@fleet.com | 13900000000 | `admin123` | super_admin | ✅ 正常 |

## 🔐 登录方式

### 方式 1：手机号登录

```
手机号：13800000001（或其他租户的手机号）
密码：password123
```

### 方式 2：邮箱登录

```
邮箱：zhangsan@sf-express.com（或其他租户的邮箱）
密码：password123
```

### 系统管理员登录

```
邮箱：admin@fleet.com
密码：admin123
```

## 📊 数据库结构

### 中央管理系统表

1. **tenants**（租户表）
   - 存储所有租户的基本信息
   - 包含租户代码、公司名称、联系信息等

2. **user_credentials**（用户认证信息表）
   - 存储所有用户的登录凭证
   - 密码使用 bcrypt 加密（轮数：10）
   - 支持手机号和邮箱登录

3. **system_admins**（系统管理员表）
   - 存储系统管理员信息
   - 用于访问中央管理系统

4. **tenant_modules**（租户模块配置表）
   - 存储每个租户启用的功能模块
   - 支持动态启用/禁用模块

5. **audit_logs**（审计日志表）
   - 记录所有系统操作
   - 用于审计和追踪

## 🔧 技术细节

### 密码加密

- **算法**：bcrypt
- **轮数**：10
- **实现**：使用 PostgreSQL 的 `crypt()` 函数

### 密码验证

```sql
-- 验证密码
SELECT 
  id,
  name,
  role
FROM user_credentials
WHERE phone = '13800000001'
  AND password_hash = crypt('password123', password_hash);
```

### JWT 认证

系统使用 JWT（JSON Web Token）进行认证：

```typescript
interface JWTPayload {
  userId: string              // 用户 ID
  tenantId: string            // 租户 ID
  role: string                // 用户角色
  phone?: string              // 手机号
  email?: string              // 邮箱
  name: string                // 姓名
  iat: number                 // 签发时间
  exp: number                 // 过期时间（7天）
}
```

## 🧪 测试场景

### 场景 1：租户老板登录

1. 使用手机号 `13800000001` 和密码 `password123` 登录
2. 系统验证密码
3. 生成 JWT Token
4. 返回用户信息和 Token
5. 前端保存 Token
6. 跳转到老板界面

### 场景 2：系统管理员登录

1. 使用邮箱 `admin@fleet.com` 和密码 `admin123` 登录
2. 系统验证密码
3. 生成 JWT Token
4. 返回管理员信息和 Token
5. 前端保存 Token
6. 跳转到中央管理系统

### 场景 3：查看租户列表

1. 系统管理员登录
2. 访问租户列表页面
3. 显示所有5个租户
4. 可以查看每个租户的详细信息

### 场景 4：创建新租户

1. 系统管理员登录
2. 点击"创建新租户"
3. 填写租户信息
4. 选择功能模块
5. 创建老板账号
6. 系统自动创建租户和用户

## 📝 注意事项

### 1. 密码安全

- ✅ 所有密码都使用 bcrypt 加密
- ✅ 密码哈希存储在数据库中
- ✅ 不存储明文密码
- ⚠️ 测试密码较简单，生产环境应使用强密码

### 2. 数据隔离

- ✅ 每个租户的数据完全隔离
- ✅ 租户之间无法访问对方的数据
- ✅ 系统管理员可以查看所有租户信息

### 3. Token 管理

- ✅ Token 有效期为 7 天
- ✅ Token 包含用户和租户信息
- ⚠️ 需要实现 Token 刷新机制
- ⚠️ 需要实现 Token 黑名单（用户登出）

### 4. 数据库连接

- ⚠️ 当前使用的是 Supabase 免费版
- ⚠️ 租户数据库尚未创建（需要 Neon 集成）
- ⚠️ 需要实现租户数据库的动态连接

## 🚀 下一步计划

### 阶段 1：完善认证系统

- [ ] 实现 JWT 认证中间件
- [ ] 实现登录 API
- [ ] 实现 Token 验证
- [ ] 实现 Token 刷新
- [ ] 实现登出功能

### 阶段 2：开发中央管理系统

- [ ] 租户列表页面
- [ ] 租户详情页面
- [ ] 租户创建页面
- [ ] 模块配置页面
- [ ] 系统管理员管理

### 阶段 3：集成 Neon 数据库

- [ ] 注册 Neon 账号
- [ ] 获取 Neon API Key
- [ ] 实现 Neon API 集成
- [ ] 实现租户数据库创建
- [ ] 实现数据库初始化

### 阶段 4：前端开发

- [ ] 更新登录页面（支持 JWT）
- [ ] 实现动态连接切换
- [ ] 更新数据查询逻辑
- [ ] 实现租户管理界面

## 📞 联系方式

如有问题，请联系开发团队。

---

**创建日期**：2025-11-27  
**文档版本**：v1.0  
**状态**：✅ 已完成
